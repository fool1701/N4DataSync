<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>bajaux Tutorial: Tips and Tricks</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.cerulean.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top navbar-inverse">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">bajaux</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-bajaux_commands_Command.html">bajaux/commands/Command</a></li><li><a href="module-bajaux_commands_CommandGroup.html">bajaux/commands/CommandGroup</a></li><li><a href="module-bajaux_commands_ToggleCommand.html">bajaux/commands/ToggleCommand</a></li><li><a href="module-bajaux_commands_ToggleCommandGroup.html">bajaux/commands/ToggleCommandGroup</a></li><li><a href="module-bajaux_container_wb_Clipboard.html">bajaux/container/wb/Clipboard</a></li><li><a href="module-bajaux_container_wb_StringList.html">bajaux/container/wb/StringList</a></li><li><a href="module-bajaux_dragdrop_dragDropUtils.html">bajaux/dragdrop/dragDropUtils</a></li><li><a href="module-bajaux_dragdrop_Envelope.html">bajaux/dragdrop/Envelope</a></li><li><a href="module-bajaux_dragdrop_NavNodeEnvelope.html">bajaux/dragdrop/NavNodeEnvelope</a></li><li><a href="module-bajaux_dragdrop_StringEnvelope.html">bajaux/dragdrop/StringEnvelope</a></li><li><a href="module-bajaux_events.html">bajaux/events</a></li><li><a href="module-bajaux_icon_iconUtils.html">bajaux/icon/iconUtils</a></li><li><a href="module-bajaux_lifecycle_WidgetManager.html">bajaux/lifecycle/WidgetManager</a></li><li><a href="module-bajaux_mixin_batchLoadMixin.html">bajaux/mixin/batchLoadMixin</a></li><li><a href="module-bajaux_mixin_batchSaveMixin.html">bajaux/mixin/batchSaveMixin</a></li><li><a href="module-bajaux_mixin_responsiveMixIn.html">bajaux/mixin/responsiveMixIn</a></li><li><a href="module-bajaux_mixin_subscriberMixIn.html">bajaux/mixin/subscriberMixIn</a></li><li><a href="module-bajaux_Properties.html">bajaux/Properties</a></li><li><a href="module-bajaux_registry_Registry.html">bajaux/registry/Registry</a></li><li><a href="module-bajaux_registry_RegistryEntry.html">bajaux/registry/RegistryEntry</a></li><li><a href="module-bajaux_spandrel.html">bajaux/spandrel</a></li><li><a href="module-bajaux_spandrel_jsx.html">bajaux/spandrel/jsx</a></li><li><a href="module-bajaux_util_CommandButton.html">bajaux/util/CommandButton</a></li><li><a href="module-bajaux_util_CommandButtonGroup.html">bajaux/util/CommandButtonGroup</a></li><li><a href="module-bajaux_util_SaveCommand.html">bajaux/util/SaveCommand</a></li><li><a href="module-bajaux_Validators.html">bajaux/Validators</a></li><li><a href="module-bajaux_Widget.html">bajaux/Widget</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="interfaces.list.html" class="dropdown-toggle" data-toggle="dropdown">Interfaces<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-bajaux_commands_Command-Undoable.html">bajaux/commands/Command~Undoable</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="tutorials.list.html" class="dropdown-toggle" data-toggle="dropdown">Tutorials<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="tutorial-10-mfw-gettingStarted.html">Getting Started - MyFirstWidget</a></li><li><a href="tutorial-20-mfw-modifying.html">Saving Modifications to Station</a></li><li><a href="tutorial-30-mfw-dashboarding.html">Making your Widget Dashboardable</a></li><li><a href="tutorial-40-tipsAndTricks.html">Tips and Tricks</a></li><li><a href="tutorial-50-spandrel.html">Building Composite Widgets With spandrel</a></li>
				</ul>
			</li>
			
		</ul>
        
            <div class="col-sm-3 col-md-3">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                        <div class="input-group-btn">
                            <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			<section class="tutorial-section">

<header>
    

    <h2>Tips and Tricks</h2>
</header>

<article>
    <h1><code>bajaux</code> Tips and Tricks</h1>
<h2>Templating methods</h2>
<p>Over the introductory tutorials, we mainly used <a href="https://handlebarsjs.com">Handlebars</a> for templating HTML. Handlebars is certainly a solid, well-supported choice. Here are some aspects of Handlebars that may make it a good fit, or a poor fit, for your particular use case:</p>
<ul>
<li>The HTML is kept in a separate file, apart from your JavaScript.</li>
<li>Escaping (see below) is automatically handled for you.</li>
<li>The logic you may embed in a template (for loops, if statements, etc.) is very limited.</li>
<li>HTML contents of elements are parsed as a string. If you are creating a large number of elements (tens of thousands or more), this can harm performance.</li>
</ul>
<p>Here are a couple alternatives you might consider.</p>
<h3>ES6 Template Strings</h3>
<p>You can simply use template strings, which are part of JavaScript itself, to build out your HTML.</p>
<pre class="prettyprint source lang-javascript"><code>class MyWidget extends Widget {
  doLoad(component) {
    this.jq().html(`
      &lt;table>
        ${ component.getSlots().toArray()
          .map((slot) => `&lt;tr>&lt;td>${ _.escape(slot.getName()) }&lt;/td>&lt;/tr>`)
          .join('') }
      &lt;/table>
    `);
  }
}
</code></pre>
<p>This way, the HTML is kept right in line with your JavaScript. You also have a lot more flexibility in terms of logic, since you are generating the HTML with JavaScript itself.</p>
<p>The downsides are again that the HTML is parsed as a string, which may have performance implications, and escaping is <em>not</em> handled for you, so you must be diligent about protecting yourself from XSS.</p>
<h3><code>spandrel.jsx</code></h3>
<p>By using the <a href="tutorial-50-spandrel.html">Building Composite Widgets With spandrel</a> module, you can use <a href="https://reactjs.org/docs/introducing-jsx.html">JSX</a> to define your widgets.</p>
<pre class="prettyprint source lang-jsx"><code>/** @jsx spandrel.jsx */

const MyWidget = spandrel((component) => {
  return (
    &lt;table>{
      component.getSlots().toArray().map((slot) => {
        return (
          &lt;tr>
            &lt;td>{slot.getName()}&lt;/td>
          &lt;/tr>
        );
      })
    }&lt;/table>
  );
});
</code></pre>
<p>(Keep in mind that JSX is not React and this does not turn your <code>bajaux</code> Widget into a React component.)</p>
<p>This approach, again, keeps your HTML right in line with your JavaScript and allows for any JavaScript logic you wish. The JSX compiles to JavaScript and native <code>HTMLElement</code>s, so at scale, performance can beat parsing HTML as strings. JSX itself also handles the XSS-escaping of the text content of elements for you.</p>
<p>Anecdotally, Tridium has been using <code>spandrel.jsx</code> almost exclusively for several releases now, so it may be a good fit for your use case as well.</p>
<h2>Escaping HTML for safety</h2>
<p>When implementing a <code>bajaux</code> Widget, you must take care to ensure that any content that could be user-generated is correctly escaped to protect your users from <a href="https://owasp.org/www-community/attacks/xss/">reflected XSS attacks</a>.</p>
<p>A reflected XSS attack could occur when a user of your station, who has limited write permissions, injects malicious JavaScript into the part of the station where they can write to. Another user with elevated permissions could then access that same part of the station, where a vulnerable Widget would cause that code to execute using their own permissions. In this way, the limited user could execute code using another user's elevated permissions, damaging the station or stealing information.</p>
<p>Whenever you display user-generated text, you must ensure that it is correctly escaped to prevent it from being added to the page as code.</p>
<p>Some examples of potentially user-generated text are:</p>
<ul>
<li>The names or display names of Components or their Slots</li>
<li>Slot Facets</li>
<li>The values of Component properties that are Strings, or displayed as Strings</li>
<li>Values retrieved from the station via RPC (e.g. <code>baja.rpc()</code>), BQL queries, etc.</li>
<li>Contents of files, which may be editable by users with write permissions to the file space</li>
<li>Text retrieved from lexicons, which may be parameterized to include values from the station's Component Space</li>
</ul>
<p>Any of these can contain information that was placed into the station by a user.</p>
<p>Some examples of methods of escaping this data for safe display are:</p>
<ul>
<li>Using <code>jQuery.text()</code> instead of <code>jQuery.html()</code></li>
<li>Setting an <code>HTMLElement</code>'s <code>textContent</code> instead of its <code>innerHtml</code></li>
<li>Using Handlebars templating</li>
<li>Using <code>spandrel.jsx</code></li>
<li>Manually escaping HTML using <code>_.escape()</code> or a similar JavaScript function</li>
</ul>
</article>

</section>

		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<footer>


	<span class="copyright">
	bajaux Copyright © 2024 Tridium. DocStrap Copyright © 2012-2013 the contributors to the JSDoc3 and DocStrap projects.
	</span>

<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.6</a>
	
		on 2024-05-03T00:28:54+00:00
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>

    <script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>


<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre, pre.prettyprint.source" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : true,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->



    <script type="text/javascript">
        $(document).ready(function() {
            SearcherDisplay.init();
        });
    </script>


</body>
</html>