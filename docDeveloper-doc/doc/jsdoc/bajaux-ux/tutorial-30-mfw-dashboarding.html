<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>bajaux Tutorial: Making your Widget Dashboardable</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.cerulean.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top navbar-inverse">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">bajaux</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-bajaux_commands_Command.html">bajaux/commands/Command</a></li><li><a href="module-bajaux_commands_CommandGroup.html">bajaux/commands/CommandGroup</a></li><li><a href="module-bajaux_commands_ToggleCommand.html">bajaux/commands/ToggleCommand</a></li><li><a href="module-bajaux_commands_ToggleCommandGroup.html">bajaux/commands/ToggleCommandGroup</a></li><li><a href="module-bajaux_container_wb_Clipboard.html">bajaux/container/wb/Clipboard</a></li><li><a href="module-bajaux_container_wb_StringList.html">bajaux/container/wb/StringList</a></li><li><a href="module-bajaux_dragdrop_dragDropUtils.html">bajaux/dragdrop/dragDropUtils</a></li><li><a href="module-bajaux_dragdrop_Envelope.html">bajaux/dragdrop/Envelope</a></li><li><a href="module-bajaux_dragdrop_NavNodeEnvelope.html">bajaux/dragdrop/NavNodeEnvelope</a></li><li><a href="module-bajaux_dragdrop_StringEnvelope.html">bajaux/dragdrop/StringEnvelope</a></li><li><a href="module-bajaux_events.html">bajaux/events</a></li><li><a href="module-bajaux_icon_iconUtils.html">bajaux/icon/iconUtils</a></li><li><a href="module-bajaux_lifecycle_WidgetManager.html">bajaux/lifecycle/WidgetManager</a></li><li><a href="module-bajaux_mixin_batchLoadMixin.html">bajaux/mixin/batchLoadMixin</a></li><li><a href="module-bajaux_mixin_batchSaveMixin.html">bajaux/mixin/batchSaveMixin</a></li><li><a href="module-bajaux_mixin_responsiveMixIn.html">bajaux/mixin/responsiveMixIn</a></li><li><a href="module-bajaux_mixin_subscriberMixIn.html">bajaux/mixin/subscriberMixIn</a></li><li><a href="module-bajaux_Properties.html">bajaux/Properties</a></li><li><a href="module-bajaux_registry_Registry.html">bajaux/registry/Registry</a></li><li><a href="module-bajaux_registry_RegistryEntry.html">bajaux/registry/RegistryEntry</a></li><li><a href="module-bajaux_spandrel.html">bajaux/spandrel</a></li><li><a href="module-bajaux_spandrel_jsx.html">bajaux/spandrel/jsx</a></li><li><a href="module-bajaux_util_CommandButton.html">bajaux/util/CommandButton</a></li><li><a href="module-bajaux_util_CommandButtonGroup.html">bajaux/util/CommandButtonGroup</a></li><li><a href="module-bajaux_util_SaveCommand.html">bajaux/util/SaveCommand</a></li><li><a href="module-bajaux_Validators.html">bajaux/Validators</a></li><li><a href="module-bajaux_Widget.html">bajaux/Widget</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="interfaces.list.html" class="dropdown-toggle" data-toggle="dropdown">Interfaces<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-bajaux_commands_Command-Undoable.html">bajaux/commands/Command~Undoable</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="tutorials.list.html" class="dropdown-toggle" data-toggle="dropdown">Tutorials<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="tutorial-10-mfw-gettingStarted.html">Getting Started - MyFirstWidget</a></li><li><a href="tutorial-20-mfw-modifying.html">Saving Modifications to Station</a></li><li><a href="tutorial-30-mfw-dashboarding.html">Making your Widget Dashboardable</a></li><li><a href="tutorial-40-tipsAndTricks.html">Tips and Tricks</a></li><li><a href="tutorial-50-spandrel.html">Building Composite Widgets With spandrel</a></li>
				</ul>
			</li>
			
		</ul>
        
            <div class="col-sm-3 col-md-3">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                        <div class="input-group-btn">
                            <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			<section class="tutorial-section">

<header>
    

    <h2>Making your Widget Dashboardable</h2>
</header>

<article>
    <p>This tutorial follows from <a href="tutorial-20-mfw-modifying.html">Saving Modifications to Station</a>.</p>
<p>We're going to modify <code>MyFirstWidget</code> to make it <a href="module://docDeveloper/doc/dashboard.html">dashboardable</a>.</p>
<h2>Outline</h2>
<pre class="prettyprint source"><code>+- myFirstModule
   +- myFirstModule-ux
      +- src
      |  +- com
      |  |  +- companyname
      |  |     +- myFirstModule
      |  |        +- ux
      |  |           +- BMyFirstWidget.java
      |  +- rc
      |     +- templates
      |     |  +- MyFirstWidget.hbs ----------------------------------*MODIFIED*
      |     +- myFirstModule.css
      |     +- MyFirstWidget.js --------------------------------------*MODIFIED*
      +- module.lexicon ----------------------------------------------*MODIFIED*
      +- module-include.xml
      +- myFirstModule-ux.gradle
</code></pre>
<h2>Drag and Drop</h2>
<p>One of the most useful features of dashboards is to allow users to drag components from the Nav tree and drop them onto a <code>Widget</code>, instantly loading the new component so the user can interact with it without navigating away from that page. On top of that, users can save the dashboard so that they always see their preferred component in that View.</p>
<p>In this example, we're adding drag-and-drop functionality to <code>MyFirstWidget</code>. When <code>MyFirstWidget</code> is shown in a dashboard, the user can drag a different <code>Ramp</code> onto it directly to bind the widget to the Ramp of their choice, instead. The ORD to that <code>Ramp</code> will be persisted in the user's dashboard data automatically.</p>
<p>The added lines of code related to this functionality have been marked as <code>*DRAG &amp; DROP*</code> in the modified <code>MyFirstWidget.js</code> file.</p>
<h2>Dashboard-only Features</h2>
<p>Sometimes a user may want to show a feature of their <code>Widget</code> only when it is contained within a dashboard. We've added a private note box at the bottom of the <code>Widget</code> to demonstrate this.</p>
<p>The added lines of code related to this functionality have been marked as <code>*DASHBOARD-ONLY NOTE*</code> in the modified <code>MyFirstWidget.js</code> file.</p>
<p>There are a lot of changes in this example - again, just skim over the code to get a feel for what's going on, and then we'll discuss in more detail.</p>
<h2>MyFirstWidget.js - modified</h2>
<pre class="prettyprint source lang-javascript"><code>/**
 * A module defining `MyFirstWidget`.
 *
 * @module nmodule/myFirstModule/rc/MyFirstWidget
 */
define([
  'baja!',
  'hbs!nmodule/myFirstModule/rc/templates/MyFirstWidget',
  'lex!myFirstModule',
  'log!nmodule.myFirstModule.rc.MyFirstWidget',
  'bajaux/Widget',
  'bajaux/dragdrop/dragDropUtils', //----------------------- *DRAG & DROP*
  'bajaux/mixin/subscriberMixIn',
  'bajaux/util/SaveCommand',
  'jquery',
  'Promise',
  'css!nmodule/myFirstModule/rc/myFirstModule' ], function (
  baja,
  template,
  lexs,
  log,
  Widget,
  dragDropUtils,
  subscriberMixIn,
  SaveCommand,
  $,
  Promise) {

  'use strict';
  
  const [ myFirstModuleLex ] = lexs;
  const logSevere = log.severe.bind(log);

  // When the dashboard is saved, dashboardable property information will be saved away
  // to the user's station, and is accessible by that user alone. Also note
  // that these dashboardable properties are not attached to the `Widget's` value, but the
  // `Widget` itself!
  
  const widgetDefaults = () => ({
    properties: {
      rootCssClass: 'MyFirstWidget',
      
      // This is where we will save the override ORD.
      overrideOrd: { //---------------------------------- *DRAG & DROP*
        value: '',
        dashboard: true,
        // Use hidden and readonly to hide this property from the user in an editor.
        hidden: true,
        readonly: true
      },
      
      // This is where we will save the contents of the private note unique to each user.
      privateNote: { //-------------------------- *DASHBOARD-ONLY NOTE*
        value: '',
        dashboard: true,
        hidden: true,
        readonly: true
      },

      // This is a special optional property that can be added to see if a
      // `Widget` is currently running on a dashboard. You do not need it to make
      // your `Widget` dashboardable. This is how we will decide whether or not to
      // show the private note textbox.
      dashboard: {
        value: false,
        hidden: true,
        readonly: true,
        transient: true
      }
    }
  });

  /**
   * An editor for working with `kitControl:Ramp` instances.
   *
   * This editor allows a user to drag and drop a new Ramp component onto it to
   * be viewed or modified instantly. This `Widget` is also dashboardable, which
   * allows a user to save the dropped override Ramp as the default one loaded.
   * Dashboarding also provides a private note text box, which only that user
   * can see and modify.
   *
   * @class
   * @extends module:bajaux/Widget
   * @alias module:nmodule/myFirstModule/rc/MyFirstWidget
   */
  return class MyFirstWidget extends Widget {
    constructor(params) {
      super({ params, defaults: widgetDefaults() });
      subscriberMixIn(this);
      this.getCommandGroup().add(new SaveCommand());
    }
    
    
    doInitialize(dom) {
      dom.html(template({
        valueLabel: myFirstModuleLex.get('MyFirstWidget.value'),
        changeValuesText: myFirstModuleLex.get('MyFirstWidget.changeValues'),
        amplitudeLabel: myFirstModuleLex.get('MyFirstWidget.amplitude'),
        enabledLabel: myFirstModuleLex.get('MyFirstWidget.enabled'),
        loadingPlaceholder: myFirstModuleLex.get('MyFirstWidget.loading'),
        noteLabel: myFirstModuleLex.get('MyFirstWidget.note'), //--------------------- *DASHBOARD-ONLY NOTE*
        // Hide private note if widget is not dashboarded.
        noteVisible: this.properties().getValue('dashboard'), // *DASHBOARD-ONLY NOTE*
        privateNote: this.properties().getValue('privateNote'), // *DASHBOARD-ONLY NOTE*
        dashboardPlaceholder: myFirstModuleLex.get('MyFirstWidget.dashboardPlaceholder') //-------------- *DASHBOARD-ONLY NOTE*
      }));

      dom.on('input', '.MyFirstWidget-amplitude', () => {
        this.setModified(true);
      });
      
      dom.on('change', '.MyFirstWidget-enabled', () => {
        this.setModified(true);
      });

      // Copy private note text to `Widget` when modified. - *DASHBOARD-ONLY NOTE*
      dom.on('input', '.MyFirstWidget-noteText', () => {
        this.properties().setValue('privateNote', this.$getNoteTextarea().val());
      });

      // Set up drag and drop. --------------------------------- *DRAG & DROP ORD*
      dom.on('dragover', (e) => {
        e.preventDefault();
      });
      
      dom.on('drop', (e) => {
        this.$updateFromDrop(e.originalEvent.dataTransfer).catch(logSevere);
        e.preventDefault();
        e.stopPropagation();
      });

      this.getSubscriber().attach('changed', () => {
        // Use override value if available. -------------------- *DRAG & DROP ORD*
        const rampToUpdate = this.$overrideVal || this.value();
        this.$updateDom(rampToUpdate);
      });

      // Set up the override ORD if it exists. ----------------- *DRAG & DROP ORD*
      return this.$resolveOverrideOrd();
    }

    /**
     * Update the DOM to show the ramp's current values.
     *
     * @param {baja.Component} ramp - an instance of `kitControl:Ramp`
     */
    doLoad(ramp) {
      // Use override value if available. -------------------- *DRAG & DROP ORD*
      const rampToUpdate = this.$overrideVal || ramp;
      
      this.$updateDom(rampToUpdate);
    }

    /**
     * Update the DOM to reflect the given Ramp's current values.
     * @private
     * @param {baja.Component} ramp a `kitControl:Ramp`
     */
    $updateDom(ramp) {
      this.$getValueDisplay().val(ramp.getOutDisplay());

      // Only update the editable DOM if the user hasn't made unsaved changes.
      if (!this.isModified()) {
        const amplitudeInput = this.$getAmplitudeInput();

        // Don't reset the user's cursor every time the value refreshes if the
        // input box has focus. They may be trying to select or edit the
        // contents.
        if (!amplitudeInput.is(':focus')) {
          amplitudeInput.val(ramp.getAmplitudeDisplay());
        }
        
        this.$getEnabledCheckbox().prop('checked', ramp.getEnabled());
      }
    }

    /**
     * Reads out the `enabled` and `amplitude` values that the user has currently entered.
     *
     * @returns {module:nmodule/myFirstModule/rc/MyFirstWidget~RampProperties}
     */
    doRead() {
      return {
        enabled: this.$getEnabledCheckbox().is(':checked'),
        amplitude: parseFloat(this.$getAmplitudeInput().val())
      };
    }

    /**
     * Save the user-entered changes to the loaded `kitControl:Ramp`.
     *
     * Note that the parameter to this function is the same as that resolved by
     * doRead().
     *
     * @param {module:nmodule/myFirstModule/rc/MyFirstWidget~RampProperties} readValue
     * @returns {Promise}
     */
    doSave(readValue) {
      // Use override value if available. ------------------ *DRAG & DROP ORD*
      const ramp = this.$overrideVal || this.value();
      
      const { enabled, amplitude } = readValue;
      return Promise.all([
        ramp.set({ slot: 'enabled', value: enabled }),
        ramp.set({ slot: 'amplitude', value: amplitude })
      ]);
    }

    /**
     * Called when a new data value is dragged and dropped onto the `Widget`.
     * Resolves a promise once the drag and drop operation has completed.
     *
     * @private
     * @param {DataTransfer} dataTransfer - The data dropped onto the Widget.
     * @returns {Promise}
     */
    $updateFromDrop(dataTransfer) { //-------------- *DRAG & DROP*
      return dragDropUtils.fromClipboard(dataTransfer)
        .then((envelope) => {
          if (envelope.getMimeType() !== 'niagara/navnodes') {
            return;
          }
          
          return envelope.toJson()
            .then((json) => {
              // Although multiple items could have been dragged and dropped
              // on, we're just going to use the first item in the list.
              const obj = json && json[0];
              const ord = obj && obj.ord;

              if (ord) {
                if (obj.typeSpec === 'kitControl:Ramp') {
                  return this.$setOverrideOrd(ord);
                } else {
                  throw new Error('Override component must be a `kitControl:Ramp`.');
                }
              }
            });
        });
    }

    /**
     * Sets up a new override ORD and unsubscribes the old one.
     *
     * @private
     * @param {string} newOverrideOrd - The new override ORD.
     * @returns {Promise}
     */
    $setOverrideOrd(newOverrideOrd) { //------------- *DRAG & DROP*
      // Record any old ORD value so we can unsubscribe it.
      const oldOverrideOrd = this.properties().getValue('overrideOrd');

      // There is no need to manually mark the `Widget` as modified here. When the
      // widget is in a dashboard, a change to widget.properties() automatically
      // does this.
      this.properties().setValue('overrideOrd', newOverrideOrd);

      return Promise.all([
        this.$resolveOverrideOrd(),
        oldOverrideOrd && baja.Ord.make(oldOverrideOrd).get()
          .then((comp) => this.getSubscriber().unsubscribe(comp))
      ]);
    }

    /**
     * Resolves any override ORD.
     *
     * @private
     * @returns {Promise}
     */
    $resolveOverrideOrd() { //------------------------ *DRAG & DROP*
      const overrideOrd = this.properties().getValue('overrideOrd');

      if (overrideOrd) {
        return baja.Ord.make(overrideOrd).get({ subscriber: this.getSubscriber() })
          .then((value) => {
            this.$overrideVal = value;
            this.$updateDom(value);
          });
      } else {
        delete this.$overrideVal;
      }
    }

    /**
     * @private
     * @returns {JQuery} the text box for the `amplitude` property
     */
    $getAmplitudeInput() {
      return this.jq().find('.MyFirstWidget-amplitude');
    }

    /**
     * @private
     * @returns {JQuery} the checkbox for the `enabled` property
     */
    $getEnabledCheckbox() {
      return this.jq().find('.MyFirstWidget-enabled');
    }

    /**
     * @private
     * @returns {JQuery} the readonly text box showing the Ramp's value
     */
    $getValueDisplay() {
      return this.jq().find('.MyFirstWidget-value');
    }

    /**
     * @private
     * @returns {JQuery} the label showing the Widget's override ORD
     */
    $getOverrideOrdDisplay() { // ------------------ *DRAG & DROP ORD*
      return this.jq().find('.MyFirstWidget-overrideOrd');
    }

    /**
     * @private
     * @returns {JQuery} the textarea containing the private note
     */
    $getNoteTextarea() { //----------------------- *DASHBOARD-ONLY NOTE*
      return this.jq().find('.MyFirstWidget-noteText');
    }
  };
});
</code></pre>
<p>First off, we're using the <code>log!</code> plugin for browser-based logging. This provides more features than just <code>console.log()</code> and can log up to the Application Director. See the <a href="module://docDeveloper/doc/jsdoc/js-ux/module-log.html">log JSDoc</a> for more details.</p>
<p>In <code>doInitialize()</code>, we've added some more properties relating to the override ORD and the dashboardable note to the Handlebars template. The contents of the dashboardable note are stored in the dashboardable <code>privateNote</code> Property. They are written to the DOM in <code>doInitialize()</code>, and as the user types, they are written back onto the <code>privateNote</code> Property. Because <code>privateNote</code> is a dashboardable Property, saving the Widget when it's on a dashboard will also save that Property.</p>
<p>We also arm new handlers for drag/drop. When we drop from the nav tree onto the Widget, the profile itself (either Workbench or HTML5 profile) will provide a specific data structure. The <code>dragDropUtils</code> module knows how to consume this data structure into an <em>envelope</em> which provides more details about what you're dropping. See the JSDoc for that module for more details, and inspect the <code>$updateFromDrop()</code> method here for an example. When the user drops a Ramp onto the Widget, it will record that Ramp's ORD as its <code>overrideOrd</code>. Again, because <code>overrideOrd</code> is a dashboardable Property, saving the Widget when it's on a dashboard will save <code>overrideOrd</code> as well.</p>
<p><code>$setOverrideOrd()</code> and <code>$resolveOverrideOrd()</code> handle the storage and resolution of an existing override ORD.</p>
<h2>MyFirstWidget.hbs - modified</h2>
<pre class="prettyprint source lang-html"><code>&#60;div class='MyFirstWidget'&#62;
  &#60;div&#62;
    &#60;label&#62;{{overrideOrdLabel}} &#60;span class='MyFirstWidget-overrideOrd'&#62;{{overrideOrd}}&#60;/span&#62;&#60;/label&#62;
  &#60;/div&#62;
  &#60;div&#62;
    &#60;label&#62;{{valueLabel}}: &#60;label&#62;
    &#60;input class='MyFirstWidget-value' type='text' value='{{loadingPlaceholder}}' readonly='readonly'/&#62;
  &#60;/div&#62;
  &#60;div&#62;
    {{changeValuesText}}
  &#60;/div&#62;
  &#60;div&#62;
    &#60;label&#62;{{amplitudeLabel}}: &#60;label&#62;
    &#60;input class='MyFirstWidget-amplitude' type='text' value='{{loading}}' /&#62;
  &#60;/div&#62;
  &#60;div&#62;
    &#60;label&#62;{{enabledLabel}}: &#60;label&#62;
    &#60;input class='MyFirstWidget-enabled' type='checkbox' value='Enabled' /&#62;
  &#60;/div&#62;
  &#60;div class='MyFirstWidget-note'{{#unless noteVisible}} style='display: none;'{{/unless}}' &#62;
    &#60;div&#62;
      {{noteLabel}}
    &#60;/div&#62;
    &#60;div&#62;
      &#60;textarea class='MyFirstWidget-noteText' rows='4' cols='50' placeholder='{{dashboardPlaceholder}}' &#62;
        {{privateNote}}
      &#60;/textarea&#62;
    &#60;/div&#62;
  &#60;/div&#62;
&#60;/div&#62;
</code></pre>
<h2>module.lexicon - modified</h2>
<pre class="prettyprint source"><code>#
# Lexicon for the my first module ux.
#

MyFirstWidget.value=Value
MyFirstWidget.changeValues=Changing these inputs modifies the widget, not the component. You must Save to push the changes to the station.
MyFirstWidget.amplitude=Amplitude
MyFirstWidget.enabled=Enabled
MyFirstWidget.loading=Loading...
MyFirstWidget.note=Private note:
MyFirstWidget.overrideOrd=Override ORD:
MyFirstWidget.dashboardPlaceholder=Thanks to the dashboard, no other users will see this text when looking at this View.
</code></pre>
<h2>Next</h2>
<p>There's a <em>lot</em> more to learn about. To explore, we're going to switch from creating a Niagara Module that embeds our JavaScript <code>Widget</code> to using some JavaScript Playground Components. These are not something we would distribute to customers for production, but offer another way to experiment with bajaux.</p>
<p>In the playground examples, you can learn about...</p>
<ul>
<li>Using Commands.</li>
<li>Using Properties.</li>
<li>DOM event handling.</li>
<li>Hyperlinking.</li>
</ul>
<ol>
<li>Ensure you have the BoxService from the box palette added to your Station's Service Container.</li>
<li>Open the <code>docDeveloper</code> palette and add the <code>BajauxExamples</code> folder to the root of your Station.</li>
<li>Make sure you're logged on as user with admin read, write and invoke privileges.</li>
<li>Using Workbench or a browser, click on the first exercise to get started.</li>
</ol>
</article>

</section>

		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<footer>


	<span class="copyright">
	bajaux Copyright © 2024 Tridium. DocStrap Copyright © 2012-2013 the contributors to the JSDoc3 and DocStrap projects.
	</span>

<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.6</a>
	
		on 2024-05-03T00:28:54+00:00
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>

    <script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>


<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre, pre.prettyprint.source" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : true,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->



    <script type="text/javascript">
        $(document).ready(function() {
            SearcherDisplay.init();
        });
    </script>


</body>
</html>