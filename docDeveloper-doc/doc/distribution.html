<!-- Htmldoc has been run -->
<!--
   @author    Matt Boon
   @creation  5 Dec 02
   @version   $Revision$ $Date$
   @since     Niagara 3.0
 -->

<html>
<head>
<title>Distribution</title>
<link rel='stylesheet' href='module://docDeveloper/rc/sunlight.default.css'>
<!-- Auto-generated style sheet link --><link rel='StyleSheet' href='module://bajaui/doc/style.css' type='text/css' />
<!-- Auto-generated js link for Activity Monitoring --><script type='text/javascript' src='module://web/rc/util/activityMonitor.js'></script>
<script type='text/javascript'>window.addEventListener('load', activityMonitor.start);</script>
</head>
<body>
<!-- Auto-generated Header NavBar --><p class="navbar">  <a href="/doc/index.html" class="navbar">Index</a> |  <a href="/doc/bog.html" class="navbar">Prev</a> |  <a href="/doc/test.html" class="navbar">Next</a></p>


<script type='text/javascript' src='module://docDeveloper/rc/sunlight-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/sunlight.xml-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/niagara-sunlight-support.js'></script>

<h1>Distributions</h1>
<h1>Overview</h1>
<p>
A distribution is a platform-specific archive of deployable software.   The
distribution file:
<ul>
  <li>Is a JAR file compliant with PKZIP compression;</li>
  <li>Contains an XML manifest in meta-inf/dist.xml;</li>
  <li>Contains files to be deployed;</li>
  <li>May contains files to assist with deployment;</li>
  <li>States its dependencies on any <em>parts</em>  such as hardware, 
    operating system, Niagara or third-party software</li>
</ul>
</p>

<h1>JAR Entry Paths</h1>
<p>The JAR entry paths mirror their intended filesystem paths directly.
Paths are mapped either to the target host's root directory or the 
{baja home} directory, according to the manifest.  Unless specified 
otherwise by the manifest or end-user request, and except for the dist.xml
manifest itself, each file will be copied to the target host (<em>i.e.</em>, 
there is no facility provided for the user or an installation program 
to choose which specific pieces to install).</p>

<h1>Manifest</h1>
<p>The distribution manifest is found in the meta-inf/dist.xml JAR entry.  
It
<ul>
  <li>provides some high-level descriptive information about the distribution,</li>
  <li>specifies the distribution's external dependencies and exclusions,</li>
  <li>provides a summary description of its contents to assist installer
    software in dependency analysis,</li>
  <li>identifies contents that should never be copied to the host,</li>
  <li>identifies resources that can assist with installation,</li>
  <li>identifies modifications that need to be made to the host's 
    platform.bog file, and </li>
  <li>specifies under which conditions existing files are to be replaced.</li>
</ul>
</p>
<p>An example distribution file manifest is provided as a reference for most of
the remaining specification:
<pre>
  <code class="sunlight-highlight-xml">
&lt;dist name="qnx-jace-york"
      version="2.1.6"
      description=""
      buildDate="Thu Jan 18 10:58:39 Eastern Standard Time 2007"
      buildHost="BRUTUS"
      reboot="true"
      noRunningApp="true"
      absoluteElementPaths="true"
      osInstall="true"
&gt;


&lt;dependencies&gt;
  &lt;part name="york" desc="York System Board" /&gt;
&lt;/dependencies&gt;

&lt;exclusions&gt;
  &lt;os name="qnx-jace-york" version="2.2" /&gt;
&lt;/exclusionss&gt;

&lt;provides&gt;
  &lt;os name="qnx-jace-york" version="2.1.6" /&gt;
&lt;/provides&gt;
&lt;fileHandling&gt;  
  &lt;file name="dev/shmem/york.image" replace="oscrc"/&gt;
&lt;/fileHandling&gt;
&lt;/dist&gt;

  </code>
</pre>
</p>
<p>
The root <b>dist</b>  element has the following attributes:
<ul>
  <li><b>name</b> [required]:  Name of the distribution.</li>
  <li><b>version</b> [required]:  Version of the distribution, dot delimited.   If version
  is nonzero, then it and the name must uniquely identify the file's contents - they <em>must not 
  be reused</em> with different contents.</li>
  <li><b>vendor</b> [optional]:  Vendor name for the provider of the 
    distribution.</li>
  <li><b>description</b> [optional]:  Brief description of the what 
    the distribution provides.</li>
  <li><b>buildDate</b> [optional]:  Timestamp for when the distribution
    was created.  May be generated by a build tool, useful in tracking 
    development builds.</li>
  <li><b>buildHost</b> [optional]:  Host on which the distribution was 
    created.  May be generated by a build tool, useful in tracking development builds.</li>
  <li><b>reboot</b> [optional]:  true or false, defaults to true.   If 
    true, the host to which this distribution is installed must be rebooted
    after installation is complete.</li>
  <li><b>noRunningApp</b> [optional]: true or false, defaults to true.   If 
    true, then the distribution may not be installed while any Niagara 
    stations or Sedona applications are running.</li>
  <li><b>absoluteElementPaths</b> [optional]:  true or false, defaults to 
    false.   If true, then the JAR entry path maps directly to the host's 
    root directory, otherwise the entry path maps to {baja_home}.</li>   
  <li><b>osInstall</b> [optional]:  true or false, defaults to false.   
    Meaningless for Win32 platforms.   If true, then the distribution 
    contains an operating system image that must be installed after the 
    files are downloaded and before the host is rebooted.</li>
  <li><b>hostId</b> [optional]: If present, represents the hostid of the system
    for which the distribution (probably a backup) was created.</li>
</ul>
</p>
<h2>platform Element [optional]</h2>
<p>
Sub-elements are XML in bog file format and will be merged <em>by name</em>
into the host's existing platform.bog file, or will be used to initialize
a new platform.bog file.  This allows a distribution to provide new platform
services without clobbering or re-initializing any existing platform services.
</p>
<h2>dependencies Element [optional]</h2>
<p>describes the <em>parts</em> which must be present on a target host
before the distribution can be installed.   Each <em>part</em>  is identified
by a sub-element:
</p>
<h3>arch element [optional]</h3>
<p>Describes a chipset dependency.   Required <b>name</b>  attribute specifies
the chipset architecture name.</p>
<h3>model element [optional]</h3>
<p>Describes a model dependency.   Required <b>name</b>  attribute specifies
the model name.</p>
<h3>os element [optional]</h3>
<p>Describes an operating system dependency.   Attributes:
<ul>
  <li><b>name</b> [required]:  operating system name</li>
  <li><b>vendor</b> [optional]:  operating system vendor</li>
  <li><b>version</b> [required]:  operating system version, dot delimited.</li>
  <li><b>rel</b> [optional]: describes how the version is evaluated.   Possible values are "minimum" (default), 
  "maximum", and "exact".</li>
</ul>
</p>
<h3>nre element [optional]</h3>
<p>Describes a dependency on a Niagara runtime version.   Attributes:
<ul>
  <li><b>name</b> [required]:  NRE name</li>
  <li><b>vendor</b> [optional]:  NRE vendor</li>
  <li><b>version</b> [required]:  NRE version, dot delimited.</li>
  <li><b>rel</b> [optional]: describes how the version is evaluated.   Possible values are "minimum" (default), 
  "maximum", and "exact".</li>
</ul>
</p>
<h3>brand element [optional]</h3>
<p>Describes a dependency on a brand.  Required attribute <b>name</b> uniquely identifies
the brand that must be specified in a target host's license for the dependency to be
met.</p>
<h3>module element [optional]</h3>
<p>Describes a module dependency.  Attributes are the same as those for the 
<b>dependency</b> element in the module.xml manifest (see modules.html), and the optional
<b>rel</b> option is supported.
</p>
<h3>part element [optional]</h3>
<p>Describes a dependency on any other kind of <em>part</em>, such as
a piece of hardware.   Required attribute <b>name</b> is a unique
name for the part, and required attribute <b>description</b> provides a
brief description.  Optional <b>version</b> attribute, if present, specifies a 
version requirement for the part, and the optional <b>rel</b> attributed specifies how the
version is evaluated.</p>
<h2>exclusions Element [optional]</h2>
<p>Describes the <em>parts</em> which must <em>not</em> be present on a target host
if the distribution is to be installed.   The sub-elements allowed are the same as 
those used in the <b>dependencies</b> section.
</p>

<h2>provides Element [optional]</h2>
<p>If present, describes exactly one <b>part</b> that is to be installed by this 
distribition, whose part name matches the distribution name (<em>i.e.</em> if the
part is named qnx-jace-james, the dist file must be named qnx-jace-james.dist).
</p>
<p>
If the distribution file doesn't contain a single discrete named, versioned part (for example
a system backup) then it must omit the provides element.  Also, if for any other reason
the distribution should not be installed automatically by an client to satisfy
dependencies expressed in other files, it must omit the provides element.
</p>
<p>The part is described by a sub-element:</p>
<h3>os element [optional]</h3>
<p>Describes an operating system element.   Attributes:
<ul>
  <li><b>name</b> [required]:  operating system name</li>
  <li><b>vendor</b> [optional]:  operating system vendor</li>
  <li><b>version</b> [required]:  operating system version, dot delimited.</li>
</ul>
</p>

<h3>vm element [optional]</h3>
<p>Describes an installable java virtual machine.   Attributes:
<ul>
  <li><b>name</b> [required]:  virtual machine name</li>
  <li><b>vendor</b> [optional]:  VM vendor</li>
  <li><b>version</b> [required]:  VM version, dot delimited.</li>
</ul>
</p>

<h3>nre element [optional]</h3>
<p>Describes an installable Niagara runtime engine (NRE).   Attributes:
<ul>
  <li><b>name</b> [required]:  NRE product name</li>
  <li><b>vendor</b> [optional]:  NRE vendor</li>
  <li><b>version</b> [required]:  NRE version, dot delimited.</li>
</ul>
</p>
<h2>resources Element [optional]:</h2>
<p>If present, specifies elements whose files are used to support the distribution's
installation, and are not to be copied to the host.   Each sub-element has a 
<b>content</b> attribute that identifies the entry path.   At this time, it may 
contain the following sub-element:</p>
<h3>installable element [optional]</h3>
<p>Describes an installable file that the installing client should import into its 
software registry (Workbench's software registry is maintained using its {baja_home}/sw 
directory). Using installable resources makes the distribution much bigger, but is useful for
creating single files that have all of the necessary contents to meet their own software
dependencies.  Attributes:</p>
<ul>
  <li><b>source</b> [required]: element path containing the installable file</li>
  <li><b>type</b> [required]: can be "module" or "dist"</li>
  <li><b>name</b> [required]: name specified by the installable's manifest</li>
  <li><b>vendor</b> [required]: vendor name specified by the installable's manifest</li>
  <li><b>vendorVersion</b> [required]: version specified by the installable's manifest</li>
</ul>

<h2>fileHandling Element [optional]</h2>
<p>
Specifies the rules by which files are replaced, and identifies 
directories and files which must be removed before installation begins.   

The optional <b>replace</b> attribute specifies the rules for replacing 
existing files - its values can be "always" if the file is always 
to be replaced, "never" if it is never to be replaced, 
and "crc" if the file is to be replaced only if the CRC checksums for 
the distribution and current versions of the file are not the same.  

By default, no files or directories are to be removed by the installer 
prior to installation, and the "crc" replacement rule is used.  The
<b>fileHandling</b> element may contain the following sub-elements:</p>
<h3>remove element</h3>
<p>
Specifies a file or directory to be removed prior to installation.   
Its required <b>name</b> attribute specifies the path (according to 
absoluteElementPaths element) to the file/directory.   If <b>name</b> 
specifies a directory, exceptions may be specified 
using the <b>keep</b> sub-element.</p>
<h3>keep element [optional]</h3>
<p>
Specifies a file or directory that should not be removed as the 
result of a <b>remove</b> element.   Its required <b>name</b> attribute 
specifies the path.
</p>
<h3>file element [optional]</h3>
<p>
Specifies a file replacement rule that differs from the 
default in the <b>fileHandling</b> element or any <b>dir</b> element that might apply
to the file's path.   Its required <b>name</b>
attribute specifies the file path, and the required <b>replace</b> 
attribute specifies the rules for replacing the existing file - its 
values can be "always" if the file is always to be replaced, 
"never" if it is never to be replaced, "crc" if the file 
is to be replaced only if the CRC checksums for the distribution 
and current versions of the file are not the same, "oscrc" if the file's
CRC checksum is to be checked against a CRC value returned by the niagarad for
the OS image, "nocopy" if the file is never to be copied to the host, or "hostid"
if the file is to be copied only if the host's hostid matches the value of the <b>dist</b> 
element's <b>hostid</b> attribute.</p> 
<h3>dir element [optional]</h3>
<p>
Specifies a file replacement rule for a given directory path that differs from
the default in the <b>fileHandling</b> element or in <b>dir</b> elements for parent
paths.  Its required <b>name</b> attribute specifies the directory's path.   Its optional
<b>replace</b> attribute can be "always", "never", "crc", "nocopy" or "hostid".   Its optional 
<b>clean</b> attribute, if present and equal to "true", indicates that any file or subdirectory 
that isn't part of the distribution should be deleted by the installer.</p>

<script type="text/javascript">
    window.niagara.docDevUtil.highlightCode();
</script>

<!-- Auto-generated Footer NavBar --><p class="navbar">  <a href="/doc/index.html" class="navbar">Index</a> |  <a href="/doc/bog.html" class="navbar">Prev</a> |  <a href="/doc/test.html" class="navbar">Next</a></p>
<!-- Auto-generated copyright note --><p class='copyright'></p>
</body>
</html>
