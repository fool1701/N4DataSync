<!-- Htmldoc has been run -->
<!doctype html>
<html>
<head>
<meta charset='utf-8'>
<link rel='stylesheet' href='module://docDeveloper/rc/sunlight.default.css'>
<!-- Auto-generated style sheet link --><link rel='StyleSheet' href='module://bajaui/doc/style.css' type='text/css' />
<!-- Auto-generated js link for Activity Monitoring --><script type='text/javascript' src='module://web/rc/util/activityMonitor.js'></script>
<script type='text/javascript'>window.addEventListener('load', activityMonitor.start);</script>
</head>
<body>
<!-- Auto-generated Header NavBar --><p class="navbar">  <a href="/doc/index.html" class="navbar">Index</a> |  <a href="/doc/js/buildingJS.html" class="navbar">Prev</a> |  <a href="/doc/ax-to-n4-module-migration.html" class="navbar">Next</a></p>

<script type='text/javascript' src='module://docDeveloper/rc/sunlight-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/sunlight.java-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/sunlight.javascript-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/sunlight.xml-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/sunlight.css-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/niagara-sunlight-support.js'></script>

<h1 class='title'>The Slot-o-matic tool</h1>
<ul>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#usage">Usage</a>
    <ul>
      <li><a href="#invocation">Invocation</a></li>
      <li><a href="#slot-o-matic-options">Slot-o-matic options</a>
        <ul>
          <li><a href="#force-recompile">Force Recompile</a></li>
          <li><a href="#include-and-exclude">Include and Exclude</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#niagara-annotations">Niagara Annotations</a>
    <ul>
      <li><a href="#useful-notes">Useful notes</a>
        <ul>
          <li><a href="#java-annotation-types">Java Annotation Types</a></li>
          <li><a href="#string-escaping-in-niagara-annotations">String Escaping in Niagara Annotations</a></li>
        </ul>
      </li>
      <li><a href="#niagaratype">@NiagaraType</a>
        <ul>
          <li><a href="#agent-attribute">agent attribute</a></li>
          <li><a href="#adapter-attribute">adapter attribute</a></li>
          <li><a href="#ext-attribute">ext attribute</a></li>
          <li><a href="#ordscheme-attribute">ordScheme attribute</a></li>
        </ul>
      </li>
      <li><a href="#slot-annotations">Slot annotations</a>
        <ul>
          <li><a href="#non-class-annotations">Non-class annotations</a></li>
          <li><a href="#common-attributes">Common attributes</a></li>
          <li><a href="#niagaraproperty">@NiagaraProperty</a></li>
          <li><a href="#niagaraaction">@NiagaraAction</a></li>
          <li><a href="#niagaratopic">@NiagaraTopic</a></li>
        </ul>
      </li>
      <li><a href="#niagaraenum">@NiagaraEnum</a>
        <ul>
          <li><a href="#range">@Range</a></li>
        </ul>
      </li>
      <li><a href="#niagarasingleton">@NiagaraSingleton</a></li>
      <li><a href="#noslotomatic">@NoSlotomatic</a></li>
    </ul>
  </li>
  <li><a href="#examples">Examples</a>
    <ul>
      <li><a href="#a-simple-class-with-slots">A simple class with slots</a></li>
      <li><a href="#an-enum-class">An enum class</a></li>
      <li><a href="#a-singleton-class">A singleton class</a></li>
      <li><a href="#overriding-a-slot">Overriding a slot</a></li>
    </ul>
  </li>
  <li><a href="#migrating-niagara-ax-slot-o-matic-code">Migrating Niagara AX Slot-o-matic code</a>
    <ul>
      <li><a href="#caveats">Caveats</a></li>
      <li><a href="#running-the-migration">Running the migration</a></li>
    </ul>
  </li>
</ul>
<h1 id="introduction">Introduction</h1>
<p>The <strong>Slot-o-matic</strong> tool is a gradle plugin that generates Java code for Baja slots based on class-level annotations on a Baja object. The generated code is placed in the same source file, and none of the other code is changed in any way</p>
<h1 id="usage">Usage</h1>
<h2 id="invocation">Invocation</h2>
<p>Slot-o-matic is invoked by gradle in a similar way to how you compile your Java code:</p>
<pre><code>gradlew :module-rt:slotomatic
</code></pre>
<p>This will process all Java files in your module that contain slot annotations and generate code for them. Slot-o-matic will compile any Java file that meets the following conditions:</p>
<ol>
  <li>The file name is of the format <em>B[A-Z]*.java</em>, e.g. <em>BObject.java</em> or <em>BSystem.java</em>, but not <em>Ball.java</em></li>
  <li>The top-level class in the file is annotated with at least one of the Niagara annotations detailed below.</li>
</ol>
<p>By default, Slot-o-matic will not compile files that have not changed since the last time the tool was run. This can be changed with properties as outlined below.</p>
<h2 id="slot-o-matic-options">Slot-o-matic options</h2>
<p>When invoking Slot-o-matic on your project, there are command line arguments that can control the behavior of Slot-o-matic. These can be provided as below:</p>
<pre><code>gradlew :module-rt:slotomatic --option1 --option2=something --option3
</code></pre>
<p>A full list of the options for this (or any other) Gradle task can be found by running the <code>help</code> command:</p>
<pre><code>gradlew help --task :module-rt:slotomatic
</code></pre>
<h3 id="force-recompile">Force Recompile</h3>
<pre><code>gradlew :module-rt:slotomatic --force
</code></pre>
<p>When run with this property set, Slot-o-matic will recompile any files it comes across, even if they have not been changed since the last time Slot-o-matic was run.</p>
<h3 id="include-and-exclude">Include and Exclude</h3>
<p>Slot-o-matic allows you include (or exclude) specific files, folders, classes, or packages when running. This is especially useful when dealing with a large codebase consisting of a mix of legacy and annotation-based slot code.</p>
<p>All include and excludes are relative to the source root of your module: src for code and srcTest for data.</p>
<p>For example, to only run Slot-o-matic on one file:</p>
<pre><code>gradlew :module-rt:slotomatic --include com/acme/driver/BAcmeDriver.java
# or
gradlew :module-rt:slotomatic --include com.acme.driver.BAcmeDriver
</code></pre>
<p>You can specify multiple files as well, and wildcards are supported:</p>
<pre><code class="batchfile">gradlew :module-rt:slotomatic --include com.acme.driver.BAcmeDriver,com.acme.driver.BAcmePoint
# Include all classes in com.acme.driver
gradlew :module-rt:slotomatic --include com.acme.driver.*
gradlew :module-rt:slotomatic --include com/acme/driver/*
</code></pre>
<p>Excludes work in the same way, but have the effect of re-slotting everything but files matching the exclude pattern</p>
<h1 id="niagara-annotations">Niagara Annotations</h1>
<p>Starting with Niagara 4, developers can use Java annotations on their Baja classes to indicate their slots and other information used by the Niagara runtime environment. All supported annotations and their usage are detailed below.</p>
<h2 id="useful-notes">Useful notes</h2>
<p>There are a few caveats/notes which apply to all Niagara annotations.</p>
<h3 id="java-annotation-types">Java Annotation Types</h3>
<p>There are three types of annotations defined by the Java language. You may see references to these different annotation types in this document:</p>
<ul>
  <li>Normal annotations, which can have a list of key-value pairs called &ldquo;attributes&rdquo;. The type of an attribute is limited to primitive types, <code>String</code>, <code>Class</code>, enum, and other annotations, as well as arrays of these types. We cannot, for example, have a <code>BObject</code> as an attribute for an annotation, so we must instead specify a String and create the <code>BObject</code> later.</li>
  <li>Single annotations, which are normal annotations which only have one attribute. If this attribute is named &ldquo;value&rdquo;, the key can be omitted when creating an annotation.</li>
  <li>Marker annotations, which have no attributes whatsoever.</li>
</ul>
<h3 id="string-escaping-in-niagara-annotations">String Escaping in Niagara Annotations</h3>
<p>Unless otherwise noted, all attributes of &ldquo;String&rdquo; type must be fully-escaped String literals. You <em>cannot</em> use String constants, even if they are in the same class that is being annotated. Although this will appear to work, Slot-o-matic will not parse them correctly and you will end up with incorrect code.</p>
<p>If quotation marks are used in a String, They need to be escaped as such:</p>
<pre><code class="sunlight-highlight-java">defaultValue=&quot;BString.make(&quot;Hello World&quot;)&quot;      // will not work because the quotes can not be parsed
defaultValue=&quot;BString.make(\&quot;Hello World\&quot;)&quot;    // will work because the quotes have been escaped
</code></pre>
<p>Nested quotes must also be escaped properly:</p>
<pre><code class="sunlight-highlight-java">defaultValue=&quot;BString.make(\&quot;He said, \&quot;Hello\&quot; to her.\&quot;)&quot;     // will not work
defaultValue=&quot;BString.make(\&quot;He said, \\\&quot;Hello\\\&quot; to her.\&quot;)&quot;   // will work
</code></pre>
<h2 id="niagaratype">@NiagaraType</h2>
<pre><code class="sunlight-highlight-java">@NiagaraType(
  agent = {
    @AgentOn(types={&quot;baja:MyNiagaraType&quot;, &quot;baja:AnotherType&quot;}, requiredPermissions=&quot;w&quot;, app=&quot;someApp&quot;, defaultAgent=Preference.PREFERRED),
    @AgentOn(types=&quot;baja:YetAnotherType&quot;),
  },
  adapter=@Adapter(from=&quot;fromInstance&quot;, to=&quot;toInstance&quot;),
  ext={@FileExt(name=&quot;myFileExt&quot;)},
  ordScheme=&quot;myOrdScheme&quot;
)
</code></pre>
<p>The <a href="module://docDeveloper/doc/nre-rt/javax/baja/nre/annotations/NiagaraType.bajadoc"><code>@NiagaraType</code></a> annotation is the most important annotation and is the only annotation that <em>all</em> Niagara types must have, even those that do not declare any slots. A <code>@NiagaraType</code> annotation is necessary for the automatic update of module-include.xml and moduleTest-include.xml.</p>
<p>Unlike the other Niagara annotations, <code>@NiagaraType</code> is processed at compile time by an annotation processor and not by Slot-o-matic. This compile-time processing is responsible for updating the module-include.xml or moduleTest-include.xml files with the correct Baja type information used by the system registry.</p>
<p><code>@NiagaraType</code> is a normal annotation, but all of its attributes are optional. If none of the attributes are needed,<code>@NiagaraType</code> can be treated as a marker annotation.</p>
<p>The <code>@NiagaraType</code> annotation has several attributes, detailed below.</p>
<h3 id="agent-attribute">agent attribute</h3>
<p>The agent attribute defines which class, if any, the <code>BObject</code> annotated with <code>@NiagaraType</code> is an agent on. This attribute is an array of <code>@AgentOn</code> annotations, and is optional.</p>
<pre><code class="sunlight-highlight-java">@AgentOn
(
 types=&quot;module:TypeName&quot;,    //The target types that the agent is registered to.  This is a String array
 requiredPermissions=&quot;w&quot;,    //The required permissions could be &quot;r&quot;, &quot;w&quot;, &quot;rw&quot;, or not used at all.
 app=&quot;myAppName&quot;,            //influence on the registry to set the correct default agent and remove the agents that do not mix well their their application.
 defaultAgent=Preference.PREFERRED   //Chooses where the agent is the preferred default.  Options are: Preference.PREFERRED, Preference.NORMAL, Preference.NOT_PREFERRED
 )
</code></pre>
<p>Since Annotations cannot contain actual <code>BObject</code>s as attributes, the <a href="module://docDeveloper/doc/nre-rt/javax/baja/nre/annotations/AgentOn.bajadoc"><code>@AgentOn</code></a> annotation wraps information about what Baja types a class is an agent on.</p>
<p>A <code>@NiagaraType</code> annotation may have any number of <code>@AgentOn</code> annotations. Additionally, <code>@AgentOn</code> annotations can declare a type as an agent on multiple types.</p>
<p>An @AgentOn annotation has four attributes:</p>
<ul>
  <li>types: A String array of Baja typespecs that the annotated class is an agent on</li>
  <li>requiredPermissions: The required permissions of the agent, as a String. This can be &ldquo;r&rdquo;, &ldquo;w&rdquo;, &ldquo;rw&rdquo;, or empty</li>
  <li>app: String name of the app this class belongs to.</li>
  <li>defaultAgent: the preference of this agent. Can be one of:</li>
  <li>Preference.NORMAL: No preference</li>
  <li>Preference.PREFERRED: Use this agent in preference to other agents</li>
  <li>Preference.NOT_PREFERRED: This agent should only be used if no other agents are available</li>
</ul>
<h3 id="adapter-attribute">adapter attribute</h3>
<p>The adapter attribute specifies a class as an &ldquo;Adapter&rdquo; from a class to a different class. An adapter converts instances of one type to instances of another type. This attribute is a single <code>@Adapter</code> annotation, and is optional.</p>
<pre><code class="sunlight-highlight-java">@Adapter
(
  from=&quot;nameOfFromType&quot;,
  to=&quot;nameOfToType&quot;
)
</code></pre>
<p>An <a href="module://docDeveloper/doc/nre-rt/javax/baja/nre/annotations/Adapter.bajadoc"><code>@Adapter</code></a> annotation defines the source type and target type of an adapter class. It has two attributes:</p>
<ul>
  <li>from: Baja typespec string of the source type (Type to be converted from)</li>
  <li>to: Baja typespec string of the destination type (Type to be converted to)</li>
</ul>
<h3 id="ext-attribute">ext attribute</h3>
<p>If a given class models a file type, this attribute lists the extensions of the file types it models. This attribute is an array of <code>@FileExt</code> annotations, and is optional</p>
<h4 id="the-fileext-annotation">The @FileExt annotation</h4>
<pre><code class="sunlight-highlight-java">@FileExt
(
  name=&quot;extName&quot;   //The name of the file extension
)
</code></pre>
<p>A <a href="module://docDeveloper/doc/nre-rt/javax/baja/nre/annotations/FileExt.bajadoc"><code>@FileExt</code></a>  annotation defines a single file extension. It has a single attribute, &ldquo;name&rdquo;, which is a String representing the file extension.</p>
<h3 id="ordscheme-attribute">ordScheme attribute</h3>
<p>The ordScheme attribute is a single String which defines the ord scheme used by the class. It is optional.</p>
<h2 id="slot-annotations">Slot annotations</h2>
<p>Slot annotations are annotations which define the frozen slots of a Baja class. These annotations are processed by the Slot-o-matic tool to automatically generate the necessary fields and methods for a Baja class.There are three slot annotations, one for each slot type. A class may have any number of these slot annotations.</p>
<h3 id="non-class-annotations">Non-class annotations</h3>
<p>As mentioned, annotations cannot contain attributes that are Java Objects. As such, annotations were created which serve as data providers for the slot annotations where primitives and String types are not sufficient. These annotations cannot be applied to a class, but are used as attributes for the class annotations listed below.</p>
<h4 id="facet">@Facet</h4>
<pre><code class="sunlight-highlight-java">@Facet(name = &quot;BFacets.MIN&quot;, value = &quot;3&quot;)
@Facet(&quot;BUtilityClass.getFacetList()&quot;)
</code></pre>
<p>A <a href="module://docDeveloper/doc/nre-rt/javax/baja/nre/annotations/Facet.bajadoc"><code>@Facet</code></a> annotation describes a single slot facet, either as a key/value pair or as a simple value. It has two attributes:</p>
<ul>
  <li>name: The String name of the facet (key). Optional. If present, can be a constant (<code>&quot;BFacets.xxx&quot;</code>) or arbitrary value. This name must be a String literal (e.g., wrapped in &quot;&quot;), even if the value it refers to is also a String literal.</li>
  <li>value: The String value of the facet. If name is not present, this is interpreted as a pure Java expression. If name is present, this is interpreted as the second argument to <code>BFacets.make()</code></li>
</ul>
<h3 id="common-attributes">Common attributes</h3>
<p>In addition to slot-specific attributes, all of the slot annotations have the following attributes:</p>
<ul>
  <li>name: The name of the slot, as a String. This is required for all slot annotations</li>
  <li>flags: A bitmask of the flags for the slot. Optional. This is an int type, so the use of the <code>Flags.FLAG</code> constants is allowed and encouraged.</li>
  <li>facets: An array of <code>@Facet</code> annotations, each describing one a facet for this slot. Optional.</li>
  <li>override: Boolean. If &ldquo;true&rdquo;, this slot is considered to &ldquo;override&rdquo; a slot in its parent class and the slot tool will only emit a slot (Property, Action, or Topic) declaration without also generating the associated methods. Note that there is no checking of whether an overridden slot actually overrides a slot in its parent class, as Slot-o-matic runs without knowledge of the compile classpath. Optional, and defaults to <code>false</code>.</li>
</ul>
<h3 id="niagaraproperty">@NiagaraProperty</h3>
<pre><code class="sunlight-highlight-java">/**
 *  This is my property.  This comment will be included in the slot definition. Please note that this is a javaDoc comment.
 */
@NiagaraProperty
(
  name = &quot;myFirstProperty&quot;,                //REQUIRED Name of the property
  type = &quot;baja:RelTime&quot;,                   //REQUIRED Property type. Supports &quot;Module:Type&quot; typespec format (preferred) or full name.Example: &quot;baja:RelTime&quot; or &quot;BRelTime&quot; are valid.
  defaultValue = &quot;BRelTime.makeHours(1)&quot;,  //REQUIRED The default value of the property
  flags= Flags.HIDDEN | Flags.ASYNC,       //Any flags the property my have. Notice that multiple flags are grouped together with the &quot;|&quot; symbol.
  facets =                                 //Any facets that the property may have.  The facet annotation works as a name-value pair. 
  {
    @Facet(name = &quot;BFacets.MIN&quot;, value = &quot;BRelTime.makeSeconds(0)&quot;),
    @Facet(name = &quot;BFacets.MAX&quot;, value = &quot;BRelTime.makeSeconds(60)&quot;)
  }
)
</code></pre>
<p>A <a href="module://docDeveloper/doc/nre-rt/javax/baja/nre/annotations/NiagaraProperty.bajadoc"><code>@NiagaraProperty</code></a> annotation defines a single Property on a <code>BComplex</code>. A <code>BComplex</code> can have any number of properties, each declared in a separate <code>@NiagaraProperty</code> annotation.</p>
<p>A <code>@NiagaraProperty</code> annotation has the following attributes, in addition to the standard attributes detailed above:</p>
<ul>
  <li>type: The type of the property, as a String. This is required. Can be a Java class (BFoobar) or a Baja typespec (baja:Foobar).</li>
  <li>defaultValue: The default value for the property. Optional, but highly recommended. This is a String which will be converted to a Java expression, unless the property type is also a String, in which case it is interpreted as a String literal.</li>
</ul>
<h3 id="niagaraaction">@NiagaraAction</h3>
<pre><code class="sunlight-highlight-java">/**
 *  This is my action.  This comment will be included in the slot definition. Please note that this is a javaDoc comment.
 */
@NiagaraAction
(
  name = &quot;myOnlyAction&quot;,                        //REQUIRED Name of the action.
  flags = Flags.HIDDEN,                         //Any flags the action my have. Note that multiple flags are grouped together with the &quot;|&quot; symbol.
  parameterType = &quot;baja:RelTime&quot;,               //Parameter type of the action. Supports &quot;Module:Type&quot; typespec format (preferred) or full name. Example: &quot;baja:RelTime&quot; or &quot;BRelTime&quot; are valid.
  defaultValue = &quot;BRelTime.makeSeconds(5)&quot;,     //The default value of the action.
  returnType = &quot;baja:RelTime&quot;,     //Return type of the action. Supports &quot;Module:Type&quot; typespec format (preferred) or full name. Example: &quot;baja:RelTime&quot; or &quot;BRelTime&quot; are valid.
  facets =                                      //Any facets that the action may have.  The facet annotation works as a name-value pair.
  {
    @Facet(name = &quot;BFacets.MIN&quot;, value = &quot;BRelTime.makeSeconds(0)&quot;),
    @Facet(name = &quot;BFacets.MAX&quot;, value = &quot;BRelTime.makeSeconds(60)&quot;)
  }
)
</code></pre>
<p>A <a href="module://docDeveloper/doc/nre-rt/javax/baja/nre/annotations/NiagaraAction.bajadoc"><code>@NiagaraAction</code></a> annotation defines a single Action on a <code>BComplex</code>. A <code>BComplex</code> can have any number of actions, each declared in a separate <code>@NiagaraAction</code> annotation.</p>
<p>A @NiagaraAction annotation has the following attributes, in addition to the standard attributes detailed above:</p>
<ul>
  <li>parameterType: The type of the action&rsquo;s single argument, as a String. Optional. If left blank, the action is assumed to take no argument. This can be a Baja typespec, a Class name, or a Java primitive.</li>
  <li>returnType: The type of the value returned by the action. Optional. If left blank, the action is assumed to return &ldquo;void&rdquo;. This can be a Baja typespec, a Class name, or a Java primitive.</li>
  <li>defaultValue: The default value for the action parameter. Required for actions which take a parameter.</li>
</ul>
<h3 id="niagaratopic">@NiagaraTopic</h3>
<pre><code class="sunlight-highlight-java">/**
 *  This is my topic.  This comment will be included in the slot definition. Please note that this is a javaDoc comment.
 */
@NiagaraTopic
(
  name = &quot;myFirstTopic&quot;,                //REQUIRED Name of the topic.
  flags = Flags.USER_DEFINED_1,         //Any flags the topic my have. Note that multiple flags are grouped together with the &quot;|&quot; symbol.
  eventType = &quot;int&quot;,        //Event type of the topic. Supports &quot;Module:Type&quot; typespec format (preferred) or full name. Example: &quot;baja:RelTime&quot; or &quot;BRelTime&quot; are valid.
  facets =                              //Any facets that the topic may have.  The facet annotation works as a name-value pair.
  {
    @Facet(name = &quot;BFacets.MIN&quot;, value = &quot;1&quot;),
    @Facet(name = &quot;BFacets.MAX&quot;, value = &quot;40&quot;)
  }
)
</code></pre>
<p>A <a href="module://docDeveloper/doc/nre-rt/javax/baja/nre/annotations/NiagaraTopic.bajadoc"><code>@NiagaraTopic</code></a> annotation defines a single Topic of a <code>BComplex</code>. A <code>BComplex</code> can have any number of topics, each declared in a separate <code>@NiagaraTopic</code> annotation.</p>
<p>A <code>@NiagaraTopic</code> annotation has the following attribute, in addition to the standard attributes detailed above:</p>
<ul>
  <li>eventType: Event type for the topic, as a String. Optional. If left blank, defaults to &ldquo;void&rdquo;. This can be a Baja typespec, a Class name, or a Java primitive.</li>
</ul>
<h2 id="niagaraenum">@NiagaraEnum</h2>
<pre><code class="sunlight-highlight-java">@NiagaraEnum
(
  range = {
    @Range(&quot;zero&quot;),                   // Let Slot-o-matic number these
    @Range(&quot;one&quot;),
    @Range(value=&quot;two&quot;),              // Can explicitly use value as the key, if needed
    @Range(value=&quot;three&quot;, ordinal=3), // Must explicitly use all keys if specifying ordinal
    @Range(value=&quot;four&quot;, ordinal=5)
  },
  defaultValue = &quot;one&quot;                // If this was not present, the default would be &quot;zero&quot;
)
</code></pre>
<p>A <a href="module://docDeveloper/doc/nre-rt/javax/baja/nre/annotations/NiagaraEnum.bajadoc"><code>@NiagaraEnum</code></a> annotation specifies that a given class is an enum. Classes annotated with <code>@NiagaraEnum</code> should extend from <code>BFrozenEnum</code>, but this is not enforced by Slot-o-matic. A class may only have one <code>@NiagaraEnum</code> annotation, and it may not have both a <code>@NiagaraEnum</code> annotation and any other Niagara annotations besides <code>@NiagaraType</code></p>
<p>A <code>@NiagaraEnum</code> annotation has two attributes:</p>
<ul>
  <li>range: An array of <code>@Range</code> annotations, each one specifying a single element in the enum&rsquo;s range. This is required.</li>
  <li>defaultValue: A String specifying the name of the default value. Optional, and if left blank will default to the first entry in the range attribute.</li>
</ul>
<h3 id="range">@Range</h3>
<p>A <a href="module://docDeveloper/doc/nre-rt/javax/baja/nre/annotations/Range.bajadoc"><code>@Range</code></a> annotation is used by the <code>@NiagaraEnum</code> to build up its range list. It has two attributes:</p>
<ul>
  <li>value: The String name of the range entry. Required. The attribute name &ldquo;value&rdquo; is not the most intuitive attribute name, but is necessary to enable the <code>@Range</code> annotation to be treated as a Single annotation if the ordinal is not needed.</li>
  <li>ordinal: The ordinal of this entry, as an int. Optional, and Slot-o-matic will auto-number this entry if omitted or set to &ldquo;-1&rdquo;</li>
</ul>
<p>A range annotation can be specified as just <code>@Range(&quot;name&quot;)</code> if auto-numbering is necessary, or can be specified with an ordinal as <code>@Range(value=&quot;name&quot;, ordinal=5)</code>. However,<code>@Range(&quot;name&quot;, ordinal=5)</code> is <strong>not</strong> valid syntax.</p>
<h2 id="niagarasingleton">@NiagaraSingleton</h2>
<pre><code class="sunlight-highlight-java">@NiagaraSingleton
</code></pre>
<p>A <a href="module://docDeveloper/doc/nre-rt/javax/baja/nre/annotations/NiagaraSingleton.bajadoc"><code>@NiagaraSingleton</code></a> annotation specifies that a given class is a singleton class. The presence of this annotation will cause Slot-o-matic to emit a <code>public static final INSTANCE</code> field in addition to the <code>TYPE</code> field.</p>
<p><code>@NiagaraSingleton</code> is a marker annotation with no attributes</p>
<h2 id="noslotomatic">@NoSlotomatic</h2>
<pre><code class="sunlight-highlight-java">@NoSlotomatic
</code></pre>
<p>A <a href="module://docDeveloper/doc/nre-rt/javax/baja/nre/annotations/NoSlotomatic.bajadoc"><code>@NoSlotomatic</code></a> annotation turns off any Slot-o-matic processing for a given type. This is useful for some types (such as certain <code>BSimple</code> subclasses). This should be used sparingly and as a feature of last resort, but it is available. Note that even when using this annotation, you <em>must</em> also use <code>@NiagaraType</code>.</p>
<p><code>@NoSlotomatic</code> is a marker annotation with no attributes</p>
<h1 id="examples">Examples</h1>
<h2 id="a-simple-class-with-slots">A simple class with slots</h2>
<pre><code class="sunlight-highlight-java">/**
 * Test input for multiple annotation slot code
 */
@NiagaraType
/** foo is the property used for stuff */
@NiagaraProperty(
  name = &quot;foo&quot;,
  type = &quot;String&quot;,
  defaultValue = &quot;sfafasf&quot;
)
/** bar is another property used for stuff.
 *  It's more complicated, so the javadoc takes more lines
 *  or something like that
 */
@NiagaraProperty(
  name = &quot;bar&quot;,
  type = &quot;BString&quot;,
  defaultValue = &quot;BString.make(\&quot;bar\&quot;)&quot;,
  flags = Flags.HIDDEN | Flags.TRANSIENT
)
/** This action will cause things to happen. Probably. */
@NiagaraAction(
  name = &quot;things&quot;,
  returnType = &quot;int&quot;
)
/** This event is fired when bar changes */
@NiagaraTopic(
  name = &quot;barChanged&quot;,
  eventType = &quot;BString&quot;,
  flags = Flags.HIDDEN
)
public class BMultiAnnotationFoobar extends BComponent
{
}
</code></pre>
<h2 id="an-enum-class">An enum class</h2>
<pre><code class="sunlight-highlight-java">/**
 * Simple Enum class
 */
@NiagaraType
@NiagaraEnum(
  range = {
    @Range(&quot;deny&quot;),
    @Range(&quot;sameorigin&quot;),
    @Range(&quot;any&quot;),
    @Range(value=&quot;none&quot;, ordinal=5)
  },
  defaultValue = &quot;sameorigin&quot;
)
public class BEnumTest extends BFrozenEnum
{
}
</code></pre>
<h2 id="a-singleton-class">A singleton class</h2>
<pre><code class="sunlight-highlight-java">/**
 * Singleton class
 */
@NiagaraType
@NiagaraSingleton
public class BSingletonTest extends BSingleton
{
}
</code></pre>
<h2 id="overriding-a-slot">Overriding a slot</h2>
<p>Note the generated code included in this example does not have any get, set, fire, or invoke methods generated for these slots</p>
<pre><code class="sunlight-highlight-java">/**
 * Test slot override mechanism
 */
@NiagaraType
@NiagaraProperty(
  name = &quot;overrideProp&quot;,
  type = &quot;String&quot;,
  defaultValue = &quot;Foo&quot;,
  flags = Flags.HIDDEN,
  override = true
)
@NiagaraTopic(
  name = &quot;overrideTopic&quot;,
  override = true
)
@NiagaraAction(
  name = &quot;overrideAction&quot;,
  flags = Flags.HIDDEN,
  override = true
)
public class BTestSlotOverride
  extends BMyClass
{
/*+ ------------ BEGIN BAJA AUTO GENERATED CODE ------------ +*/
/*@ $slotomaticModule.annotationTests.BTestSlotOverride(1213737594)1.0$ @*/
/* Generated Fri Sep 11 09:16:22 EDT 2015 by Slot-o-matic (c) Tridium, Inc. 2012 */
////////////////////////////////////////////////////////////////
// Property &quot;overrideProp&quot;
////////////////////////////////////////////////////////////////
   
  /**
   * Slot for the {@code overrideProp} property.
   * @see #getOverrideProp
   * @see #setOverrideProp
   */
  public static final Property overrideProp = newProperty(Flags.HIDDEN, &quot;Foo&quot;,null);
////////////////////////////////////////////////////////////////
// Action &quot;overrideAction&quot;
////////////////////////////////////////////////////////////////
   
  /**
   * Slot for the {@code overrideAction} action.
   * @see #overrideAction()
   */
  public static final Action overrideAction = newAction(Flags.HIDDEN,null);
////////////////////////////////////////////////////////////////
// Topic &quot;overrideTopic&quot;
////////////////////////////////////////////////////////////////
   
  /**
   * Slot for the {@code overrideTopic} topic.
   * @see #fireOverrideTopic
   */
  public static final Topic overrideTopic = newTopic(0,null);
////////////////////////////////////////////////////////////////
// Type
////////////////////////////////////////////////////////////////
   
  @Override
  public Type getType() { return TYPE; }
  public static final Type TYPE = Sys.loadType(BTestSlotOverride.class);
/*+ ------------ END BAJA AUTO GENERATED CODE -------------- +*/
}
</code></pre>
<h1 id="migrating-niagara-ax-slot-o-matic-code">Migrating Niagara AX Slot-o-matic code</h1>
<p>In Niagara AX, a different format for Slot-o-matic code was used. This format used a special Java comment block with additional characters to indicate the presence of a Baja comment block. While this syntax will continue to be supported in N4, it is highly recommended that developers migrate to using the new Annotation syntax. Baja comment block syntax will not receive any new features (including slot overrides).</p>
<p>To make the task of migrating old Slot-o-matic code easier, the Slot-o-matic tool can automatically migrate existing Baja comment block code to Annotation code.</p>
<p>Additionally, the migration can also add <code>@NiagaraType</code> annotations to types that are present in <code>module-include.xml</code> or <code>moduleTest-include.xml</code> but that do not have any Baja comment block code.</p>
<h2 id="caveats">Caveats</h2>
<p>While the migration process is robust, there are still several caveats to keep in mind when running the Slot-o-matic migration tool:</p>
<ul>
  <li>There may be a disconnect between a Baja comment block and the generated Java code derived from that block. Pay special attention to flag and facet values, as it is fairly easy to change them in the Java code when developing while forgetting to update the Baja comment block accordingly.</li>
  <li>Although great care has been taken to reduce the risk of data loss, there may be some lost data from module-include.xml or moduleTest-include.xml when migrating. If these files are changed after compiling a migrated module, it is highly recommended to carefully examine the changed file.</li>
</ul>
<h2 id="running-the-migration">Running the migration</h2>
<p>The migration is a two-step process:</p>
<ol>
  <li>Parse Java files containing Baja comment block and replace the Baja comment block with Annotation code</li>
  <li>Re-slot the Java file using the annotation code data</li>
</ol>
<p>The recommended approach is to perform a two-pass compile:</p>
<pre><code>gradlew :module-rt:migrateSlotomatic --import
gradlew :module-rt:slotomatic
</code></pre>
<p>The <code>--import</code> flag is also required to inject <code>@NiagaraType</code> on any types defined in <code>module(Test)-include.xml</code>. This is recommended as adding <code>@NiagaraType</code> to all types allows for fully automatic generation of <code>module(Test)-include.xml</code>.</p>

<script type='text/javascript'>window.niagara.docDevUtil.highlightCode();</script>

<!-- Auto-generated Footer NavBar --><p class="navbar">  <a href="/doc/index.html" class="navbar">Index</a> |  <a href="/doc/js/buildingJS.html" class="navbar">Prev</a> |  <a href="/doc/ax-to-n4-module-migration.html" class="navbar">Next</a></p>
<!-- Auto-generated copyright note --><p class='copyright'></p>
</body>
</html>
