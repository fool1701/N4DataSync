<!-- Htmldoc has been run -->
<!doctype html>
<html>
<head>
<meta charset='utf-8'>
<link rel='stylesheet' href='module://docDeveloper/rc/sunlight.default.css'>
<!-- Auto-generated style sheet link --><link rel='StyleSheet' href='module://bajaui/doc/style.css' type='text/css' />
<!-- Auto-generated js link for Activity Monitoring --><script type='text/javascript' src='module://web/rc/util/activityMonitor.js'></script>
<script type='text/javascript'>window.addEventListener('load', activityMonitor.start);</script>
</head>
<body>
<!-- Auto-generated Header NavBar --><p class="navbar">  <a href="/doc/index.html" class="navbar">Index</a> |  <a href="/doc/apiInfo.html" class="navbar">Prev</a> |  <a href="/doc/objectModel.html" class="navbar">Next</a></p>

<script type='text/javascript' src='module://docDeveloper/rc/sunlight-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/sunlight.java-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/sunlight.javascript-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/sunlight.xml-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/sunlight.css-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/niagara-sunlight-support.js'></script>

<!--
   @author    Brian Frank
   @creation  2 Oct 01
   @version   $Revision$ $Date$
   @since     Niagara 3.0
 -->
<h1 class='title'>Modules</h1>
<h2 id="contents">Contents</h2>
<ul>
  <li><a href="#overview">Overview</a></li>
  <li><a href="#runtimeProfile">Runtime Profile</a></li>
  <li><a href="#versions">Versions</a></li>
  <li><a href="#manifest">Manifest</a></li>
</ul>
<h1 id="overview">Overview</h1>
<p>The first step in understanding the Niagara architecture is to grasp the concept of modules. Modules are the unit of deployment and versioning in the Niagara architecture. A module is a set of related <b>module files</b> having the same module name.</p>
<p>A module file:</p>
<ul>
  <li>Is a JAR file compliant with PKZIP compression</li>
  <li>Contains a XML manifest in meta-inf/module.xml</li>
  <li>Is independently versioned and deployable</li>
  <li>States its dependencies on other module files and their versions</li>
  <li>Has contents for a single <b>runtime profile</b></li>
</ul>
<p>Additionally, a module file has a <b>module part name</b> that is used by other module files to declare dependencies against it. The module part name is usually a concatenation of the module name and runtime profile (<em>e.g.</em> control-rt), but in a few cases is set explicitly in the module file&rsquo;s <b>manifest</b>.</p>
<h1 id="runtimeProfile">Runtime Profile</h1>
<p>A runtime profile is used in the following ways:</p>
<ul>
  <li>Describes the contents of a module file</li>
  <li>Describes the capabilities of a Niagara Runtime Environment in a way that the bootstrap can filter out module files that can&rsquo;t be or aren&rsquo;t configured to be used (<em>e.g.</em> headless station, full Java UI with doc, <em>etc.</em>)</li>
  <li>Allows installer tools to correctly decide which module files should be installed to a particular Niagara system</li>
</ul>
<p>Runtime profiles describe what a module file&rsquo;s contents are used for, and if the contents include Java classes, which Java Runtime profiles can load them. The table below uses the module files that comprise the control module as an example:</p>
<table>
    <tr>
        <th width="10%">Runtime Profile</th>
        <th width="10%">Example Module Name</th>
        <th width="10%">Built with JRE Version</th>
        <th width="70%">Notes</th>
    </tr>
    <tr>
        <td><code>rt</code></td>
        <td><code>control-rt</code></td>
        <td>Java 8 Compact 3</td>
        <td>Data model and communication: Fox, Box and Web Servlets</td>
    </tr>
    <tr>
        <td><code>ux</code></td>
        <td><code>control-ux</code></td>
        <td>Java 8 Compact 3</td>
        <td>BajaUX,HTML5,CSS,JavaScript code providing web-based user interaction</td>
    </tr>
    <tr>
        <td><code>wb</code></td>
        <td><code>control-wb</code></td>
        <td>Java 8 SE</td>
        <td>Java code supporting old Workbench-based user interaction - views, field editors, etc.
        These JARs inject AWT dependencies at runtime if AWT is supported on the platform. They are
        a special case where a single jar file contains code that is compiled against Java SE but
        executes in a compact3 environment. Special care must be taken by developers to avoid using
        classes that may not be present.</td>
    </tr>
    <tr>
        <td><code>se</code></td>
        <td><code>control-se</code></td>
        <td>Java 8 SE</td>
        <td>Anything that has a direct dependence upon Java SE code - database technologies, AWT,
        Swing, etc.</td>
    </tr>
    <tr>
        <td><code>doc</code></td>
        <td><code>control-doc</code></td>
        <td>N/A</td>
        <td>Documentation.   Includes no class files or other runnable content.</td>
    </tr>
</table>
<h1 id="versions">Versions</h1>
<p>Versions are specified as a series of whole numbers separated by periods, for example &ldquo;1.0.34.179&rdquo;. Two versions can be compared resulting in equality, less than, or greater than. This comparison is made by comparing the version numbers from left to right. If two versions are equal, except one contains more numbers, then the longer version is considered greater than the shorter version. For example:</p>
<pre>
  2.0 &gt; 1.0
  2.0 &gt; 1.8
  2.0.45 &gt; 2.0.43
  1.0.24.2 &gt; 1.0.24
</pre>
<p>Every module declares a &ldquo;vendor&rdquo; name and &ldquo;vendorVersion&rdquo;. The vendor name is a case insensitive identifier for the company who developed the module and the vendorVersion identifies the vendor&rsquo;s specific version of that module.</p>
<p>Tridium&rsquo;s vendorVersions are formatted as &ldquo;major.minor.iteration.build[.patch]&rdquo;:</p>
<ul>
  <li>Major and minor declare a feature release such as 3.0.</li>
  <li>The third number specifies an iteration. It increments during the development lifecycle of a feature release.</li>
  <li>The fourth number specifies a build number. A build number starts at zero for each iteration and increments each time all the software modules are built.</li>
  <li>Additional numbers may be specified for code changes made off a branch of a specific build. These are usually patch builds for minor changes and bug fixes.</li>
</ul>
<p>So the vendorVersion &ldquo;4.1.22.16&rdquo; represents a module of iteration 22 and build 16 in Niagara release 4.1. The vendorVersion &ldquo;4.1.22.16.2&rdquo; is the second patch of iteration 22 and build 16 in Niagara release 4.1.</p>
<h1 id="manifest">Manifest</h1>
<p>All module JAR files must include a manifest file in &ldquo;meta-inf/module.xml&rdquo;. The best way to examine the contents of this file is to take an example:</p>
<pre><code class="sunlight-highlight-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;module
   name = &quot;control&quot;
   runtimeProfile = &quot;rt&quot;
   vendor = &quot;Tridium&quot;
   vendorVersion = &quot;4.0.22.16&quot;
   description = &quot;Niagara Control Module&quot;
   preferredSymbol = &quot;c&quot;
&gt;

&lt;moduleParts&gt;
  &lt;modulePart name=&quot;control-wb&quot; runtimeProfile=&quot;wb&quot;/&gt;
  &lt;modulePart name=&quot;control-doc&quot; runtimeProfile=&quot;doc&quot;/&gt;
&lt;/moduleParts&gt;

&lt;dependencies&gt;
  &lt;dependency name=&quot;baja&quot; vendor=&quot;Tridium&quot; vendorVersion=&quot;4.0&quot;/&gt;
  &lt;dependency name=&quot;bql-rt&quot; vendor=&quot;Tridium&quot; vendorVersion=&quot;4.0&quot;/&gt;
  &lt;dependency name=&quot;gx-rt&quot; vendor=&quot;Tridium&quot; vendorVersion=&quot;4.0&quot;/&gt;
&lt;/dependencies&gt;

&lt;dirs&gt;
  &lt;dir name=&quot;javax/baja/control&quot;/&gt;
  &lt;dir name=&quot;javax/baja/control/enum&quot;/&gt;
  &lt;dir name=&quot;javax/baja/control/ext&quot;/&gt;
  &lt;dir name=&quot;javax/baja/control/trigger&quot;/&gt;
  &lt;dir name=&quot;javax/baja/control/util&quot;/&gt;
&lt;/dirs&gt;

&lt;defs&gt;
  &lt;def name=&quot;control.foo&quot; value=&quot;something&quot;/&gt;
&lt;/defs&gt;

&lt;types&gt;
  &lt;type name=&quot;FooBar&quot; class=&quot;javax.baja.control.BFooBar&quot;/&gt;
&lt;/types&gt;

&lt;lexicons brand=&quot;*&quot;&gt;
  &lt;lexicon module=&quot;bajaui&quot; resource=&quot;fr/bajaui_fr.lexicon&quot; language=&quot;fr&quot;/&gt;
&lt;/lexicons&gt;

&lt;/module&gt;
</code></pre>
<p>Looking at the root <code>module</code> element the following attributes are required:</p>
<ul>
  <li><b>name</b>: The globally unique name of the module that the file comprises. Developers should use a unique prefix for their modules to avoid name collisions. Module names must be one to 25 ASCII characters in length.</li>
  <li><b>vendor</b>: The company name of the module&rsquo;s owner.</li>
  <li><b>vendorVersion</b>: Vendor specific version as discussed above.</li>
  <li><b>description</b>: A short summary of the module&rsquo;s purpose.</li>
  <li><b>preferredSymbol</b>: This is used during XML serialization.</li>
  <li><b>runtimeProfile</b>: Describes the contents of the module file as described in the runtime profile section above. There may be only one module file having a particular combination of module name, runtime profile and version.</li>
</ul>
<p>Additionally, the root <code>module</code> element may have an optional <b>modulePartName</b> attribute which provides the module part name for the file. If omitted, the module part name will be a concatenation of the module name and the runtime profile, for example &ldquo;control-rt&rdquo;.</p>
<p>If the module is composed of more than one module file, then the manifest for the file with the lowest runtimeProfile (rt being lowest, doc being highest) must identify the other module files by including a <code>moduleParts</code> element. That element contains one or more <b>modulePart</b> sub-elements, each of which has a mandatory <b>runtimeProfile</b> attribute and a mandatory <b>name</b> attribute which specifies the module part name (not the module name or file name!) for a sibling module file.</p>
<p>All modules must include a <code>dirs</code> element, which contains a <code>dir</code> subelement for each of the module&rsquo;s content directories. Each <code>dir</code> has a <b>name</b> attribute which contains a system-home relative file path for a directory in the module.</p>
<p>All module files include zero or one <code>dependencies</code> element. This element contains zero or more <code>dependency</code> elements which enumerate the module&rsquo;s dependencies.  Dependencies must be resolved by the framework before the module can be successfully used. Each dependency has one required attribute. The <b>name</b> attribute specifies the module part name (not the file name or module name!) for the dependent module file. The <b>vendorVersion</b> attribute specifies the lowest vendorVersion of the dependent module file required. It is assumed that higher versions of a module are backward compatible, thus any version greater than the one specified in a dependency is considered usable. The <b>vendor</b> attribute may be specified without the <b>vendorVersion</b> attribute, but not <em>vice versa</em>. Module files having the <code>doc</code> runtimeProfile may have no dependencies, nor can other module files specify dependencies on them. Additionally, dependencies toward other module files are limited as described in the table below:</p>
<table>
    <tr>
        <th rowspan="2">&nbsp;</th>
        <th rowspan="2">&nbsp;</th>
        <th colspan="5">Target Module File's Runtime Profile</th>
    </tr>
    <tr>
        <th><code>rt</code></th>
        <th><code>ux</code></th>
        <th><code>wb</code></th>
        <th><code>se</code></th>
        <th><code>doc</code></th>
    </tr>
    <tr>
        <th rowspan="5">Declaring Module File's Runtime Profile</th>
        <th><code>rt</code></th>
        <td>Yes</td>
        <td>No</td>
        <td>No</td>
        <td>No</td>
        <td>No</td>
    </tr>
    <tr>
        <th><code>ux</code></th>
        <td>Yes</td>
        <td>Yes</td>
        <td>No</td>
        <td>No</td>
        <td>No</td>
    </tr>
    <tr>
        <th><code>wb</code></th>
        <td>Yes</td>
        <td>Yes</td>
        <td>Yes</td>
        <td>No</td>
        <td>No</td>
    </tr>
    <tr>
        <th><code>se</code></th>
        <td>Yes</td>
        <td>Yes</td>
        <td>Yes</td>
        <td>Yes</td>
        <td>No</td>
    </tr>
    <tr>
        <th><code>doc</code></th>
        <td>No</td>
        <td>No</td>
        <td>No</td>
        <td>No</td>
        <td>No</td>
    </tr>
</table>
<p>Modules can declare zero or more <code>def</code> elements which store String name/value pairs. The defs from all modules are collapsed into a global def database by the <a href="registry.html">registry</a>.</p>
<p>Modules which contain concrete Niagara <code>BObjects</code> also include a <code>types</code> element.  This element includes zero or more <code>type</code> elements. Each <code>type</code> element defines a mapping between a Baja type name and a Java class name. This definition is specified in the two required attributes <b>type</b> and <b>class</b>.</p>
<p>Modules can declare zero or one <code>lexicons</code> element, which contains zero or more <code>lexicon</code> elements. The lexicon has an optional <code>brand</code> attribute which filters lexicon file usage based on brand. The value of this attribute may contain &ldquo;*&rdquo; (string) or &ldquo;?&rdquo; (single character) wildcards. Each lexicon will associate a resource file containing lexicon properties with a specific module. Typically modules containing lexicons will not contain other elements, but it is possible to include lexicon files in any module. Lexicon information is loaded into a global lexicon database by the <a href="registry.html">registry</a>. This data is used by the lexicon system to apply locale-specific elements (text, icons, etc.) as needed.</p>

<script type='text/javascript'>window.niagara.docDevUtil.highlightCode();</script>

<!-- Auto-generated Footer NavBar --><p class="navbar">  <a href="/doc/index.html" class="navbar">Index</a> |  <a href="/doc/apiInfo.html" class="navbar">Prev</a> |  <a href="/doc/objectModel.html" class="navbar">Next</a></p>
<!-- Auto-generated copyright note --><p class='copyright'></p>
</body>
</html>
