<!-- Htmldoc has been run -->
<!doctype html>
<html>
<head>
<meta charset='utf-8'>
<link rel='stylesheet' href='module://docDeveloper/rc/sunlight.default.css'>
<!-- Auto-generated style sheet link --><link rel='StyleSheet' href='module://bajaui/doc/style.css' type='text/css' />
<!-- Auto-generated js link for Activity Monitoring --><script type='text/javascript' src='module://web/rc/util/activityMonitor.js'></script>
<script type='text/javascript'>window.addEventListener('load', activityMonitor.start);</script>
</head>
<body>
<!-- Auto-generated Header NavBar --><p class="navbar">  <a href="/doc/index.html" class="navbar">Index</a> |  <a href="/doc/autoLogoffWeb.html" class="navbar">Prev</a> |  <a href="/doc/servlets/webModules.html" class="navbar">Next</a></p>

<script type='text/javascript' src='module://docDeveloper/rc/sunlight-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/sunlight.java-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/sunlight.javascript-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/sunlight.xml-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/sunlight.css-min.js'></script>
<script type='text/javascript' src='module://docDeveloper/rc/niagara-sunlight-support.js'></script>

<h1 id="user-activity-monitoring-and-auto-logoff">User Activity Monitoring and Auto Logoff</h1>
<p>Activity monitoring works out of the box with most workbench views and will keep a user&rsquo;s session alive as long as user input is happening. As long as the active ord target is pointing to a fox session, this will work out of the box. If you have written a custom view that uses a fox session, but is not loaded on a station component, special handling may be required.</p>
<h2 id="activitylistener">ActivityListener</h2>
<p>If your view is not loaded on a station component, any fox session(s) that it uses will not be automatically kept alive. In this case, your view will have to listen for user input, and notify the fox session(s) of the activity. This can be done using the <a href="module://docDeveloper/doc/workbench-wb/javax/baja/workbench/BWbShell.ActivityListener.bajadoc">ActivityListener</a> interface. Any ActivityListener added to a <a href="module://docDeveloper/doc/workbench-wb/javax/baja/workbench/BWbShell">BWbShell</a> will have the activity() method called each time user activity is detected in Workbench. The userActivity() method on <a href="module://docDeveloper/doc/fox-rt/javax/baja/fox/BFoxProxySession">BFoxProxySession</a> can then be called to keep the session alive.</p>
<pre><code class="sunlight-highlight-java">public class BMyView extends BWbView implements ActivityListener
{
  @Override
  public void activated()
  {
    // add activity listener when activated
    getWbShell().addActivityListener(this);
  }

  @Override
  public void deactivated()
  {
    // remove activity listener when deactivated
    getWbShell().removeActivityListener(this);
  }
  
  @Override
  public void activity()
  {
    if (!isVisible())
    {
      // do not keep the session alive if this view is not visible
      return;
    }
    session.userActivity();
  }
  
  private BFoxProxySession session; // initialize and connect this session when view is loaded
}
</code></pre>
<h2 id="notifylistener">NotifyListener</h2>
<p>In addition to notifying the session to activity, it is also advisable to notify the user when the session is about to expire. Again, this functionality works out of the box for most views and special handling is only necessary if your view is not loaded on a station component. This can be done using the <a href="module://docDeveloper/doc/fox-rt/javax/baja/fox/BFoxProxySession.NotifyListener.bajadoc">NotifyListener</a> interface. Any NotifyListener added to a <a href="module://docDeveloper/doc/fox-rt/javax/baja/fox/BFoxProxySession">BFoxProxySession</a> will have the onNotify() method called when the session will expire in 30 seconds or less. The notifyTimeout() method on a <a href="module://docDeveloper/doc/workbench-wb/javax/baja/workbench/BWbShell">BWbShell</a> can be used to display a dialog to the user stating that the session is about to timeout. The onNotify() method should return true if the user elected to continue the session, and false otherwise. This can be accomplished by returning the value returned by BWbShell.notifyTimeout().</p>
<pre><code class="sunlight-highlight-java">public class BMyView extends BWbView implements NotifyListener
{
  @Override
  public void doLoadValue(BObject value, Context cx)
  {
    // connect to the fox session
    ...
    session.addNotifyListener(this);
    ...
  }
  
  @Override
  public void deactivated()
  {
    // remove activity listener when deactivated
    session.removeNotifyListener(this);
  }
  
  @Override
  public boolean onNotify(BFoxProxySession session)
  {
    return getWbShell().notifyTimeout(this, session);
  }
    
  private BFoxProxySession session; // initialize and connect this session when view is loaded
}
</code></pre>
<h2 id="pause-activity-monitor">Pause Activity Monitor</h2>
<p>You may have a scenario in which your view uses a fox session to do some processing that may take an extended period of time. In this case, the activity monitor can be &ldquo;paused&rdquo; so that the session will be kept alive until the processing is complete, even if user input is not occurring. It is important to make sure that the activity monitor is resumed after processing is complete, otherwise the session will not time out as expected.</p>
<pre><code class="sunlight-highlight-java">public class BMyView extends BWbView
{
  @Override
  public void doLoadValue(BObject value, Context cx)
  {
    BFoxProxySession session;
    // connect to the fox session
    ...
    Object pauseToken = null;
    try
    {
      pauseToken = session.pauseActivityMonitor();
      ...
    }
    finally
    {
      // resume the activity monitor here so it will not be skipped if an exception is thrown
      session.resumeActivityMonitor(pauseToken);
    }
  }
}
</code></pre>

<script type='text/javascript'>window.niagara.docDevUtil.highlightCode();</script>

<!-- Auto-generated Footer NavBar --><p class="navbar">  <a href="/doc/index.html" class="navbar">Index</a> |  <a href="/doc/autoLogoffWeb.html" class="navbar">Prev</a> |  <a href="/doc/servlets/webModules.html" class="navbar">Next</a></p>
<!-- Auto-generated copyright note --><p class='copyright'></p>
</body>
</html>
