<!-- Htmldoc has been run -->
<!--
   @author    Scott Hoye
   @creation  24 Jan 05
   @version   $Revision$ $Date$
   @since     Niagara 3.0
 -->
 
<html>

<head>
<title>Basic Driver</title>
<!-- Auto-generated style sheet link --><link rel='StyleSheet' href='module://bajaui/doc/style.css' type='text/css' />
<!-- Auto-generated js link for Activity Monitoring --><script type='text/javascript' src='module://web/rc/util/activityMonitor.js'></script>
<script type='text/javascript'>window.addEventListener('load', activityMonitor.start);</script>
</head>

<body>
<!-- Auto-generated Header NavBar --><p class="navbar">  <a href="/doc/index.html" class="navbar">Index</a> |  <a href="/doc/driverSchedule.html" class="navbar">Prev</a> |  <a href="/doc/bacnet.html" class="navbar">Next</a></p>


<!-- Header Navbar -->
<!-- Title Block -->
<h1 class='title'>Basic Driver</h1> 

<!------------------------------------------------------------->
<h1>Overview</h1>
<!------------------------------------------------------------->

<p>
Refer to the <a href='module://docDeveloper/doc/basicDriver-rt/module-index.bajadoc'>Basic Driver API</a>.
</p>

<p>
This package provides some basic classes that may be useful to developers building 
a new driver (i.e. field bus driver).  These classes can be used (or subclassed) to
provide some basic driver functionality, such as worker (queue) management, basic
poll schedule handling, basic messages and management of these basic messages
through request/response transactions (as well as unsolicited message handling), etc.
It also provides a serial implementation 
(<a href='module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/serial/package-index.bajadoc'>com.tridium.basicdriver.serial</a>) 
which can be subclassed by drivers that use a serial port for communication.
Here is an overview of basicDriver's structure:
</p>

<p>
<pre>
                BBasicNetwork
               /   /    |    \
              /   /     |     \
  BBasicDevices  /      |   Worker Queues (BBasicWorkers)
                /       |    - dispatcher (used for
               /        |      synchronizing access to Comm)
BBasicPollScheduler     |    - worker (for posting async
                        |      operations, such as learns)
                        |    - write worker (for posting
                        |      async coalescing operations,
                        |      such as writes)
                        |
                      Comm
                     /  |  \
                    /   |   \
       CommReceiver     |   CommTransactionManager
       CommTransmitter  |    - CommTransactions
                        |
                        |
             UnsolicitedMessageListeners
          (registered if needed by network)
</pre>
</p>

<p>
The abstract class <a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/BBasicNetwork.bajadoc">BBasicNetwork</a> 
is the root component of basicDriver.  It is the base container for 
<a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/BBasicDevice.bajadoc">BBasicDevice</a> 
objects, and it provides a basic poll scheduler where objects implementing the 
<a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/util/BIBasicPollable.bajadoc">BIBasicPollable</a> 
interface can register to be polled (i.e. points, devices).  It also provides three worker
threads (queues) for handling asynchonous operations and synchronization of request messages
to the <a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/comm/Comm.bajadoc">Comm</a> 
for transmission to the output stream (the following outlines the INTENDED
use of these worker queues):
</p>

<p>
Asynchronous operations should be posted onto either
the worker queue or write worker queue (coalescing).
Write operations should always go to the write
worker queue so they will be coalesced.  Most other
asynchronous operations, such as learns, should be
posted to the worker queue to keep the write worker
queue free for write operations.  As these async
operations are processed (dequeued), they should post
any necessary message requests to the dispatcher queue,
which synchronizes access to the <code>Comm</code> (<code>Comm</code> is
ultimately responsible for sending the request message
to the output stream via the <code>CommTransmitter</code> and
receiving the response message from the input stream
via the <code>CommReceiver</code>).  Other threads may also post
directly to the dispatcher queue (for example, the
poll thread can post poll message requests directly to
the dispatcher queue).
</p>

<p>
<pre>   
    worker queue           write worker queue   
        ___                       ___
       |___|                     |___|
       |___|                     |___|
       |___|                     |___|
       |___|                     |___|
       |___|                     |___|
         |                         |
         |    dispatcher queue     |
         |          ___            |
         --------+ |___| +----------
   --------------+ |___|
   |               |___| (The dispatcher queue
  poll             |___|  is intended to handle
  requests         |___|  message requests only)
                     |
                     |
                     |
                     ---------+ send a request message
                                to Comm to transmit to
                                the output stream, and
                                wait for and return
                                any response from the
                                input stream.
</pre>
</p>

<!------------------------------------------------------------->
<h1>Supporting Classes</h1>
<!------------------------------------------------------------->

<p>
<code>BBasicNetwork</code> also handles initialization, starting, and stopping
the <code>Comm</code>, or communication handler.  <code>Comm</code>
is used to manage request/response message transactions for the network, handles the 
interaction between the low-level transmitter and receiver, and routes any
unsolicited received messages to the appropriate listener.  <code>Comm</code>
uses the following supporting classes to accomplish its tasks:
  <ul>
    <li><a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/comm/CommTransactionManager.bajadoc">CommTransactionManager</a>: 
    provides a pool of <a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/comm/CommTransaction.bajadoc">CommTransaction</a> 
    objects that are used for request/response message matching.  Matching a request 
    message to a response message is determined through an <code>Object</code> 
    tag on the <code>Message</code> (discussed below).</li>
    <li><a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/comm/CommReceiver.bajadoc">CommReceiver</a>: 
    an abstract class implementing <code>Runnable</code> which handles receiving and forming 
    <code>ReceivedMessage</code>s from the input stream.  Subclasses must override the 
    <code>receive()</code> abstract method to read and return a complete <code>ReceivedMessage</code>.  
    <code>CommReceiver</code> will loop and continuously call <code>receive()</code> in order 
    to receive messages.  Once a complete <code>ReceivedMessage</code> is received, this class 
    routes the <code>ReceivedMessage</code> back up to the <code>Comm</code> for further 
    processing.  The returned <code>ReceivedMessage</code> may also need to contain data for 
    request/response message matching (tag data) and unsolicited message listener processing 
    (unsolicited listener code).</li>
    <li><a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/comm/CommTransmitter.bajadoc">CommTransmitter</a>: 
    provides access and synchronization for writing <code>Message</code>s (and/or bytes) to 
    the output stream.</li>
    <li><a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/UnsolicitedMessageListener.bajadoc">UnsolicitedMessageListener</a>: 
    <code>Comm</code> can store a list of objects implementing this interface in order to process 
    unsolicited received messages.  <code>UnsolicitedMessageListener</code> objects can be 
    registered to the <code>Comm</code> with an unsolicited listener code key.  Then when a 
    <code>ReceivedMessage</code> is received and determined to be unsolicited, it can match 
    the unsolicited listener code to determine which <code>UnsolicitedMessageListener</code> 
    instance should handle the <code>ReceivedMessage</code>.</li>
    <li><a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/MessageListener.bajadoc">MessageListener</a>: 
    This is a helper interface that should be implemented by objects that wish to receive a 
    response <code>Message</code>.  When using the <code>sendAsync()</code> or 
    <code>sendAsyncWrite()</code> convenience methods of <code>BBasicNetwork</code>,
    they require a parameter of type <code>MessageListener</code> in order to determine 
    where to route the response <code>Message</code>.</li>
  </ul>
</p>

<!------------------------------------------------------------->
<h1>Messages</h1>
<!------------------------------------------------------------->

<p>
The <a href='module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/message/package-index.bajadoc'>com.tridium.basicdriver.message</a> 
package contains classes useful for building driver messages (using the <code>Message</code> 
abstract class), allowing these <code>Message</code>s to be written to the output stream, 
and formatting a response received (<code>ReceivedMessage</code>) into a proper <code>Message</code>.
  <ul>
    <li><a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/message/Message.bajadoc">Message</a>: 
    an abstract class for wrapping a driver message and providing some methods necessary for 
    handling a response to this message.  At a minimum, subclasses will need to provide the 
    implementation for writing the message to the output stream and determine how a response 
    (<code>ReceivedMessage</code>) should be interpreted and formed into a <code>Message</code>.</li>
    <li><a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/message/ReceivedMessage.bajadoc">ReceivedMessage</a>: 
    an abstract class for wrapping a received driver message and providing some methods for 
    determining if it is unsolicited and/or the unsolicited listener code to
    use for finding the correct <code>UnsolicitedMessageListener</code> if the message is 
    determined to be unsolicited.  Subclasses should provide a means to serve the appropriate
    data to form a complete <code>Message</code>.</li>
  </ul>
</p>

<!------------------------------------------------------------->
<h1>Utility Classes</h1>
<!------------------------------------------------------------->

<p>
The <a href='module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/util/package-index.bajadoc'>com.tridium.basicdriver.util</a> 
package contains utility classes useful to most drivers.  
  <ul>
    <li><a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/util/BasicException.bajadoc">BasicException</a>: 
    an extension of <a href="module://docDeveloper/doc/baja-rt/javax/baja/sys/BajaRuntimeException.bajadoc">BajaRuntimeException</a>, 
    a <code>BasicException</code> can be thrown when an error occurs in the driver.</li>
    <li><a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/util/BBasicWorker.bajadoc">BBasicWorker</a>: 
    an extension of <a href="module://docDeveloper/doc/baja-rt/javax/baja/util/BWorker.bajadoc">BWorker</a>, 
    it manages a basic worker thread for a queue.  Used by the <code>BBasicNetwork</code> 
    for the asynchronous worker.</li>
    <li><a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/util/BBasicCoalescingWorker.bajadoc">BBasicCoalescingWorker</a>: 
    an extension of <code>BBasicWorker</code>, it manages a basic worker thread for a 
    coalescing queue.  Used by the <code>BBasicNetwork</code> for the asynchronous
    write worker.</li>
    <li><a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/util/BBasicPollScheduler.bajadoc">BBasicPollScheduler</a>: 
    an extension of <a href="module://docDeveloper/doc/driver-rt/javax/baja/driver/util/BPollScheduler.bajadoc">BPollScheduler</a>,
    it handles subscribing, unsubscribing, and polling of <code>BIBasicPollable</code> objects.</li>
    <li><a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/util/BIBasicPollable.bajadoc">BIBasicPollable</a>: 
    an extension of <a href="module://docDeveloper/doc/driver-rt/javax/baja/driver/util/BIPollable.bajadoc">BIPollable</a>,
    this interface should be implemented by any objects that wish to register to receive poll requests
    from the <code>BBasicPollScheduler</code>.  Subclasses of basicDriver can use this to poll any
    devices, points, etc. as needed.</li>
  </ul>
</p>

<!------------------------------------------------------------->
<h1>Serial Driver</h1>
<!------------------------------------------------------------->

<p>
The <a href='module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/serial/package-index.bajadoc'>com.tridium.basicdriver.serial</a> 
package contains classes useful to most serial drivers (with the communication handler, 
<code>Comm</code>, at the network level).  
  <ul>
    <li><a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/serial/BSerialNetwork.bajadoc">BSerialNetwork</a>: 
    an extension of <code>BBasicNetwork</code> that supports serial communication on a 
    single configurable serial port.  This abstract class can be subclassed to provide a 
    frozen property of type <a href="module://docDeveloper/doc/serial-rt/javax/baja/serial/BSerialHelper.bajadoc">BSerialHelper</a>.
    This property, called 'Serial Port Config', provides an end user the ability to configure
    a serial port and its settings (i.e. baud rate, data bits, etc.) to use for communication with devices
    on the serial network.</li>
    <li><a href="module://docDeveloper/doc/basicDriver-rt/com/tridium/basicdriver/serial/SerialComm.bajadoc">SerialComm</a>: 
    an extension of <code>Comm</code> that handles opening the user selected serial port as 
    well as the input and output streams to that port.  It is used by
    the <code>BSerialNetwork</code> to handle synchronization of the serial communication.</li>
  </ul>
</p>


<!-- Auto-generated Footer NavBar --><p class="navbar">  <a href="/doc/index.html" class="navbar">Index</a> |  <a href="/doc/driverSchedule.html" class="navbar">Prev</a> |  <a href="/doc/bacnet.html" class="navbar">Next</a></p>
<!-- Auto-generated copyright note --><p class='copyright'></p>
</body>
</html>
